2025-07-21 16:22:59,905 - __main__ - INFO - Processing HTML files from C:\Users\rabieii.amin\Desktop\tender clustering\data\input
2025-07-21 16:22:59,905 - __main__ - INFO - Found 1 HTML files
2025-07-21 16:22:59,906 - __main__ - INFO - Parsing t.html.html
2025-07-21 16:23:05,535 - __main__ - INFO - Saved tender information to C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\t.html_20250721_162304.xlsx
2025-07-21 16:23:05,536 - __main__ - INFO - Successfully processed 1 HTML files
2025-07-21 16:23:05,536 - __main__ - INFO - AI processing and email sending not yet implemented
2025-07-21 16:24:35,296 - __main__ - INFO - Processing HTML files from C:\Users\rabieii.amin\Desktop\tender clustering\data\input
2025-07-21 16:24:35,296 - __main__ - INFO - Found 1 HTML files
2025-07-21 16:24:35,297 - __main__ - INFO - Parsing t.html.html
2025-07-21 16:24:40,800 - __main__ - INFO - Saved tender information to C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\t.html_20250721_162440.xlsx
2025-07-21 16:24:40,801 - __main__ - INFO - Successfully processed 1 HTML files
2025-07-21 16:24:40,802 - __main__ - INFO - AI processing and email sending not yet implemented
2025-07-23 09:54:27,657 - __main__ - INFO - Processing HTML files from C:\Users\rabieii.amin\Desktop\tender clustering\data\input
2025-07-23 09:54:27,657 - __main__ - INFO - Found 1 HTML files
2025-07-23 09:54:27,657 - __main__ - INFO - Parsing t2.html.html
2025-07-23 09:54:41,315 - __main__ - INFO - Saved tender information to C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\t2.html_20250723_095440.xlsx
2025-07-23 09:54:41,315 - __main__ - INFO - Successfully processed 1 HTML files
2025-07-23 09:54:41,315 - __main__ - INFO - AI processing and email sending not yet implemented
2025-07-26 15:03:12,303 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-07-26 15:03:12,303 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\t2.html_20250723_095440.xlsx
2025-07-26 15:03:12,304 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\t2.html_20250723_095440.xlsx
2025-07-26 15:03:12,622 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250726_150312.xlsx
2025-07-26 15:03:13,078 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-07-26 15:03:13,078 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250726_150312.xlsx
2025-07-26 15:03:13,099 - src.processing.ai_processor - INFO - Filtering 301 tenders
2025-07-26 15:03:13,100 - src.processing.ai_processor - INFO - Sending request to language model
2025-07-26 15:03:24,628 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-07-26 15:03:24,633 - src.processing.ai_processor - INFO - Parsing language model response
2025-07-26 15:03:24,634 - src.processing.ai_processor - INFO - Found 12 consulting tenders
2025-07-26 15:03:24,635 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250726_150312.xlsx
2025-07-26 15:03:24,645 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\t2.html_20250723_095440.xlsx
2025-07-26 15:03:24,697 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250726_150312.xlsx
2025-07-26 15:03:24,709 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250726_150312.xlsx
2025-07-26 15:03:24,709 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_t2.html_20250723_095440.xlsx
2025-07-27 07:40:00,042 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-07-27 07:40:00,043 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\t2.html_20250723_095440.xlsx
2025-07-27 07:40:00,043 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\t2.html_20250723_095440.xlsx
2025-07-27 07:40:00,302 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250727_074000.xlsx
2025-07-27 07:40:00,759 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-07-27 07:40:00,759 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250727_074000.xlsx
2025-07-27 07:40:00,780 - src.processing.ai_processor - INFO - Filtering 301 tenders
2025-07-27 07:40:00,781 - src.processing.ai_processor - INFO - Sending request to language model
2025-07-27 07:40:04,857 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-07-27 07:40:04,863 - src.processing.ai_processor - INFO - Parsing language model response
2025-07-27 07:40:04,863 - src.processing.ai_processor - INFO - Found 12 consulting tenders
2025-07-27 07:40:04,865 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250727_074000.xlsx
2025-07-27 07:40:04,874 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\t2.html_20250723_095440.xlsx
2025-07-27 07:40:04,927 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250727_074000.xlsx
2025-07-27 07:40:04,938 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250727_074000.xlsx
2025-07-27 07:40:04,938 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_t2.html_20250723_095440.xlsx
2025-07-27 07:40:55,225 - __main__ - INFO - Processing HTML files from C:\Users\rabieii.amin\Desktop\tender clustering\data\input
2025-07-27 07:40:55,226 - __main__ - INFO - Found 1 HTML files
2025-07-27 07:40:55,226 - __main__ - INFO - Parsing 1404-04-30- ‰Ê»  ”Ê„ ”«⁄  16.45.html
2025-07-27 07:41:07,066 - __main__ - INFO - Saved tender information to C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\1404-04-30- ‰Ê»  ”Ê„ ”«⁄  16.45_20250727_074106.xlsx
2025-07-27 07:41:07,066 - __main__ - INFO - Successfully processed 1 HTML files
2025-07-27 07:41:07,066 - __main__ - INFO - AI processing and email sending not yet implemented
2025-07-27 07:41:28,710 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-07-27 07:41:28,710 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\1404-04-30- ‰Ê»  ”Ê„ ”«⁄  16.45_20250727_074106.xlsx
2025-07-27 07:41:28,710 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\1404-04-30- ‰Ê»  ”Ê„ ”«⁄  16.45_20250727_074106.xlsx
2025-07-27 07:41:28,955 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250727_074128.xlsx
2025-07-27 07:41:29,410 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-07-27 07:41:29,410 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250727_074128.xlsx
2025-07-27 07:41:29,430 - src.processing.ai_processor - INFO - Filtering 266 tenders
2025-07-27 07:41:29,431 - src.processing.ai_processor - INFO - Sending request to language model
2025-07-27 07:41:33,160 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-07-27 07:41:33,166 - src.processing.ai_processor - INFO - Parsing language model response
2025-07-27 07:41:33,166 - src.processing.ai_processor - INFO - Found 16 consulting tenders
2025-07-27 07:41:33,168 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250727_074128.xlsx
2025-07-27 07:41:33,182 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\1404-04-30- ‰Ê»  ”Ê„ ”«⁄  16.45_20250727_074106.xlsx
2025-07-27 07:41:33,230 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250727_074128.xlsx
2025-07-27 07:41:33,241 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250727_074128.xlsx
2025-07-27 07:41:33,241 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_1404-04-30- ‰Ê»  ”Ê„ ”«⁄  16.45_20250727_074106.xlsx
2025-07-27 08:02:02,968 - __main__ - INFO - Processing HTML files from C:\Users\rabieii.amin\Desktop\tender clustering\data\input
2025-07-27 08:02:02,968 - __main__ - INFO - Found 1 HTML files
2025-07-27 08:02:02,969 - __main__ - INFO - Parsing 52385_1404-04-31 ”«⁄  16 »⁄œ «“ ŸÂ— - Main.html
2025-07-27 08:02:16,420 - __main__ - INFO - Saved tender information to C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\52385_1404-04-31 ”«⁄  16 »⁄œ «“ ŸÂ— - Main_20250727_080216.xlsx
2025-07-27 08:02:16,420 - __main__ - INFO - Successfully processed 1 HTML files
2025-07-27 08:02:16,420 - __main__ - INFO - AI processing and email sending not yet implemented
2025-07-27 08:02:47,640 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-07-27 08:02:47,644 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\52385_1404-04-31 ”«⁄  16 »⁄œ «“ ŸÂ— - Main_20250727_080216.xlsx
2025-07-27 08:02:47,644 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\52385_1404-04-31 ”«⁄  16 »⁄œ «“ ŸÂ— - Main_20250727_080216.xlsx
2025-07-27 08:02:47,890 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250727_080247.xlsx
2025-07-27 08:02:48,348 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-07-27 08:02:48,348 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250727_080247.xlsx
2025-07-27 08:02:48,369 - src.processing.ai_processor - INFO - Filtering 301 tenders
2025-07-27 08:02:48,370 - src.processing.ai_processor - INFO - Sending request to language model
2025-07-27 08:02:59,478 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-07-27 08:02:59,485 - src.processing.ai_processor - INFO - Parsing language model response
2025-07-27 08:02:59,485 - src.processing.ai_processor - INFO - Found 12 consulting tenders
2025-07-27 08:02:59,487 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250727_080247.xlsx
2025-07-27 08:02:59,499 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\52385_1404-04-31 ”«⁄  16 »⁄œ «“ ŸÂ— - Main_20250727_080216.xlsx
2025-07-27 08:02:59,551 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250727_080247.xlsx
2025-07-27 08:02:59,574 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250727_080247.xlsx
2025-07-27 08:02:59,575 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_52385_1404-04-31 ”«⁄  16 »⁄œ «“ ŸÂ— - Main_20250727_080216.xlsx
2025-07-27 08:13:04,437 - __main__ - INFO - Processing HTML files from C:\Users\rabieii.amin\Desktop\tender clustering\data\input
2025-07-27 08:13:04,438 - __main__ - INFO - Found 1 HTML files
2025-07-27 08:13:04,438 - __main__ - INFO - Parsing 1404-04-30- ‰Ê»  ”Ê„ ”«⁄  16.45.html
2025-07-27 08:13:16,278 - __main__ - INFO - Saved tender information to C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\1404-04-30- ‰Ê»  ”Ê„ ”«⁄  16.45_20250727_081316.xlsx
2025-07-27 08:13:16,278 - __main__ - INFO - Successfully processed 1 HTML files
2025-07-27 08:13:16,279 - __main__ - INFO - AI processing and email sending not yet implemented
2025-07-27 08:14:04,938 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-07-27 08:14:04,938 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\1404-04-30- ‰Ê»  ”Ê„ ”«⁄  16.45_20250727_081316.xlsx
2025-07-27 08:14:04,939 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\1404-04-30- ‰Ê»  ”Ê„ ”«⁄  16.45_20250727_081316.xlsx
2025-07-27 08:14:05,175 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250727_081404.xlsx
2025-07-27 08:14:05,612 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-07-27 08:14:05,612 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250727_081404.xlsx
2025-07-27 08:14:05,631 - src.processing.ai_processor - INFO - Filtering 266 tenders
2025-07-27 08:14:05,632 - src.processing.ai_processor - INFO - Sending request to language model
2025-07-27 08:14:17,568 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-07-27 08:14:17,574 - src.processing.ai_processor - INFO - Parsing language model response
2025-07-27 08:14:17,575 - src.processing.ai_processor - INFO - Found 16 consulting tenders
2025-07-27 08:14:17,576 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250727_081404.xlsx
2025-07-27 08:14:17,587 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\1404-04-30- ‰Ê»  ”Ê„ ”«⁄  16.45_20250727_081316.xlsx
2025-07-27 08:14:17,634 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250727_081404.xlsx
2025-07-27 08:14:17,644 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250727_081404.xlsx
2025-07-27 08:14:17,645 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_1404-04-30- ‰Ê»  ”Ê„ ”«⁄  16.45_20250727_081316.xlsx
2025-07-27 08:36:02,480 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-07-27 08:36:02,480 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\1404-04-30- ‰Ê»  ”Ê„ ”«⁄  16.45_20250727_081316.xlsx
2025-07-27 08:36:02,480 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\1404-04-30- ‰Ê»  ”Ê„ ”«⁄  16.45_20250727_081316.xlsx
2025-07-27 08:36:02,721 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250727_083602.xlsx
2025-07-27 08:36:03,174 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-07-27 08:36:03,174 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250727_083602.xlsx
2025-07-27 08:36:03,193 - src.processing.ai_processor - INFO - Filtering 266 tenders
2025-07-27 08:36:03,194 - src.processing.ai_processor - INFO - Sending request to language model
2025-07-27 08:36:07,354 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-07-27 08:36:07,358 - src.processing.ai_processor - INFO - Parsing language model response
2025-07-27 08:36:07,358 - src.processing.ai_processor - INFO - Found 16 consulting tenders
2025-07-27 08:36:07,359 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250727_083602.xlsx
2025-07-27 08:36:07,370 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\1404-04-30- ‰Ê»  ”Ê„ ”«⁄  16.45_20250727_081316.xlsx
2025-07-27 08:36:07,417 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250727_083602.xlsx
2025-07-27 08:36:07,428 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250727_083602.xlsx
2025-07-27 08:36:07,429 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_1404-04-30- ‰Ê»  ”Ê„ ”«⁄  16.45_20250727_081316.xlsx
2025-07-29 14:17:18,601 - __main__ - INFO - Processing HTML files from C:\Users\rabieii.amin\Desktop\tender clustering\data\input
2025-07-29 14:17:18,601 - __main__ - INFO - Found 1 HTML files
2025-07-29 14:17:18,602 - __main__ - INFO - Parsing 4.html
2025-07-29 14:17:43,911 - __main__ - INFO - Saved tender information to C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4_20250729_141743.xlsx
2025-07-29 14:17:43,911 - __main__ - INFO - Successfully processed 1 HTML files
2025-07-29 14:17:43,912 - __main__ - INFO - AI processing and email sending not yet implemented
2025-07-29 14:18:23,231 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-07-29 14:18:23,232 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4_20250729_141743.xlsx
2025-07-29 14:18:23,232 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4_20250729_141743.xlsx
2025-07-29 14:18:23,547 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250729_141823.xlsx
2025-07-29 14:18:24,005 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-07-29 14:18:24,005 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250729_141823.xlsx
2025-07-29 14:18:24,038 - src.processing.ai_processor - INFO - Filtering 563 tenders
2025-07-29 14:18:24,039 - src.processing.ai_processor - INFO - Sending request to language model
2025-07-29 14:18:26,821 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-07-29 14:18:26,824 - src.processing.ai_processor - ERROR - Error filtering consulting tenders: Error code: 400 - {'error': {'message': "This model's maximum context length is exceeded. Please reduce the length of your prompt or completion.", 'type': 'context_window_exceeded', 'param': 'messages', 'code': 'context_window_exceeded', 'solution': 'The input is too long for this model. Try reducing the length of your input or using a model with a larger context window. You can find models with different context lengths at https://chat.avalai.ir/platform/models'}}
2025-07-29 14:18:26,824 - src.processing.ai_processor - ERROR - Error processing Excel file: Error code: 400 - {'error': {'message': "This model's maximum context length is exceeded. Please reduce the length of your prompt or completion.", 'type': 'context_window_exceeded', 'param': 'messages', 'code': 'context_window_exceeded', 'solution': 'The input is too long for this model. Try reducing the length of your input or using a model with a larger context window. You can find models with different context lengths at https://chat.avalai.ir/platform/models'}}
2025-07-29 14:18:26,824 - __main__ - ERROR - An error occurred: Error code: 400 - {'error': {'message': "This model's maximum context length is exceeded. Please reduce the length of your prompt or completion.", 'type': 'context_window_exceeded', 'param': 'messages', 'code': 'context_window_exceeded', 'solution': 'The input is too long for this model. Try reducing the length of your input or using a model with a larger context window. You can find models with different context lengths at https://chat.avalai.ir/platform/models'}}
2025-07-29 14:18:26,841 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\rabieii.amin\Desktop\tender clustering\process_tenders.py", line 138, in main
    result_path = processor.process_excel(
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rabieii.amin\Desktop\tender clustering\src\processing\ai_processor.py", line 212, in process_excel
    tender_ids = self.filter_consulting_tenders(tenders_data)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rabieii.amin\Desktop\tender clustering\src\processing\ai_processor.py", line 150, in filter_consulting_tenders
    response = self.client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_utils\_utils.py", line 287, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\resources\chat\completions\completions.py", line 925, in create
    return self._post(
           ^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_base_client.py", line 1239, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_base_client.py", line 1034, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': "This model's maximum context length is exceeded. Please reduce the length of your prompt or completion.", 'type': 'context_window_exceeded', 'param': 'messages', 'code': 'context_window_exceeded', 'solution': 'The input is too long for this model. Try reducing the length of your input or using a model with a larger context window. You can find models with different context lengths at https://chat.avalai.ir/platform/models'}}

2025-07-29 14:20:14,536 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-07-29 14:20:14,537 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4_20250729_141743.xlsx
2025-07-29 14:20:14,537 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4_20250729_141743.xlsx
2025-07-29 14:20:14,847 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250729_142014.xlsx
2025-07-29 14:20:15,303 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-07-29 14:20:15,303 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250729_142014.xlsx
2025-07-29 14:20:15,336 - src.processing.ai_processor - INFO - Filtering 563 tenders
2025-07-29 14:20:15,338 - src.processing.ai_processor - INFO - Sending request to language model
2025-07-29 14:20:19,053 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-07-29 14:20:19,056 - src.processing.ai_processor - ERROR - Error filtering consulting tenders: Error code: 400 - {'error': {'message': "This model's maximum context length is exceeded. Please reduce the length of your prompt or completion.", 'type': 'context_window_exceeded', 'param': 'messages', 'code': 'context_window_exceeded', 'solution': 'The input is too long for this model. Try reducing the length of your input or using a model with a larger context window. You can find models with different context lengths at https://chat.avalai.ir/platform/models'}}
2025-07-29 14:20:19,057 - src.processing.ai_processor - ERROR - Error processing Excel file: Error code: 400 - {'error': {'message': "This model's maximum context length is exceeded. Please reduce the length of your prompt or completion.", 'type': 'context_window_exceeded', 'param': 'messages', 'code': 'context_window_exceeded', 'solution': 'The input is too long for this model. Try reducing the length of your input or using a model with a larger context window. You can find models with different context lengths at https://chat.avalai.ir/platform/models'}}
2025-07-29 14:20:19,057 - __main__ - ERROR - An error occurred: Error code: 400 - {'error': {'message': "This model's maximum context length is exceeded. Please reduce the length of your prompt or completion.", 'type': 'context_window_exceeded', 'param': 'messages', 'code': 'context_window_exceeded', 'solution': 'The input is too long for this model. Try reducing the length of your input or using a model with a larger context window. You can find models with different context lengths at https://chat.avalai.ir/platform/models'}}
2025-07-29 14:20:19,064 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\rabieii.amin\Desktop\tender clustering\process_tenders.py", line 138, in main
    result_path = processor.process_excel(
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rabieii.amin\Desktop\tender clustering\src\processing\ai_processor.py", line 212, in process_excel
    tender_ids = self.filter_consulting_tenders(tenders_data)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rabieii.amin\Desktop\tender clustering\src\processing\ai_processor.py", line 150, in filter_consulting_tenders
    response = self.client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_utils\_utils.py", line 287, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\resources\chat\completions\completions.py", line 925, in create
    return self._post(
           ^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_base_client.py", line 1239, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_base_client.py", line 1034, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': "This model's maximum context length is exceeded. Please reduce the length of your prompt or completion.", 'type': 'context_window_exceeded', 'param': 'messages', 'code': 'context_window_exceeded', 'solution': 'The input is too long for this model. Try reducing the length of your input or using a model with a larger context window. You can find models with different context lengths at https://chat.avalai.ir/platform/models'}}

2025-07-29 14:21:38,139 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-07-29 14:21:38,140 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4_20250729_141743.xlsx
2025-07-29 14:21:38,140 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4_20250729_141743.xlsx
2025-07-29 14:21:38,450 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250729_142138.xlsx
2025-07-29 14:21:38,633 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-07-29 14:21:38,634 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250729_142138.xlsx
2025-07-29 14:21:38,667 - src.processing.ai_processor - INFO - Filtering 563 tenders
2025-07-29 14:21:38,668 - src.processing.ai_processor - INFO - Sending request to language model
2025-07-29 14:21:40,391 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-07-29 14:21:40,394 - src.processing.ai_processor - ERROR - Error filtering consulting tenders: Error code: 400 - {'error': {'message': "This model's maximum context length is exceeded. Please reduce the length of your prompt or completion.", 'type': 'context_window_exceeded', 'param': 'messages', 'code': 'context_window_exceeded', 'solution': 'The input is too long for this model. Try reducing the length of your input or using a model with a larger context window. You can find models with different context lengths at https://chat.avalai.ir/platform/models'}}
2025-07-29 14:21:40,395 - src.processing.ai_processor - ERROR - Error processing Excel file: Error code: 400 - {'error': {'message': "This model's maximum context length is exceeded. Please reduce the length of your prompt or completion.", 'type': 'context_window_exceeded', 'param': 'messages', 'code': 'context_window_exceeded', 'solution': 'The input is too long for this model. Try reducing the length of your input or using a model with a larger context window. You can find models with different context lengths at https://chat.avalai.ir/platform/models'}}
2025-07-29 14:21:40,395 - __main__ - ERROR - An error occurred: Error code: 400 - {'error': {'message': "This model's maximum context length is exceeded. Please reduce the length of your prompt or completion.", 'type': 'context_window_exceeded', 'param': 'messages', 'code': 'context_window_exceeded', 'solution': 'The input is too long for this model. Try reducing the length of your input or using a model with a larger context window. You can find models with different context lengths at https://chat.avalai.ir/platform/models'}}
2025-07-29 14:21:40,402 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\rabieii.amin\Desktop\tender clustering\process_tenders.py", line 138, in main
    result_path = processor.process_excel(
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rabieii.amin\Desktop\tender clustering\src\processing\ai_processor.py", line 212, in process_excel
    tender_ids = self.filter_consulting_tenders(tenders_data)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rabieii.amin\Desktop\tender clustering\src\processing\ai_processor.py", line 150, in filter_consulting_tenders
    response = self.client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_utils\_utils.py", line 287, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\resources\chat\completions\completions.py", line 925, in create
    return self._post(
           ^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_base_client.py", line 1239, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_base_client.py", line 1034, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': "This model's maximum context length is exceeded. Please reduce the length of your prompt or completion.", 'type': 'context_window_exceeded', 'param': 'messages', 'code': 'context_window_exceeded', 'solution': 'The input is too long for this model. Try reducing the length of your input or using a model with a larger context window. You can find models with different context lengths at https://chat.avalai.ir/platform/models'}}

2025-07-29 14:22:23,562 - __main__ - INFO - Processing HTML files from C:\Users\rabieii.amin\Desktop\tender clustering\data\input
2025-07-29 14:22:23,562 - __main__ - INFO - Found 1 HTML files
2025-07-29 14:22:23,563 - __main__ - INFO - Parsing 1.html
2025-07-29 14:22:48,911 - __main__ - INFO - Saved tender information to C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\1_20250729_142248.xlsx
2025-07-29 14:22:48,911 - __main__ - INFO - Successfully processed 1 HTML files
2025-07-29 14:22:48,911 - __main__ - INFO - AI processing and email sending not yet implemented
2025-07-29 14:22:55,808 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-07-29 14:22:55,808 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\1_20250729_142248.xlsx
2025-07-29 14:22:55,808 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\1_20250729_142248.xlsx
2025-07-29 14:22:56,122 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250729_142255.xlsx
2025-07-29 14:22:56,306 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-07-29 14:22:56,306 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250729_142255.xlsx
2025-07-29 14:22:56,339 - src.processing.ai_processor - INFO - Filtering 563 tenders
2025-07-29 14:22:56,341 - src.processing.ai_processor - INFO - Sending request to language model
2025-07-29 14:22:57,941 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-07-29 14:22:57,942 - src.processing.ai_processor - ERROR - Error filtering consulting tenders: Error code: 400 - {'error': {'message': "This model's maximum context length is exceeded. Please reduce the length of your prompt or completion.", 'type': 'context_window_exceeded', 'param': 'messages', 'code': 'context_window_exceeded', 'solution': 'The input is too long for this model. Try reducing the length of your input or using a model with a larger context window. You can find models with different context lengths at https://chat.avalai.ir/platform/models'}}
2025-07-29 14:22:57,943 - src.processing.ai_processor - ERROR - Error processing Excel file: Error code: 400 - {'error': {'message': "This model's maximum context length is exceeded. Please reduce the length of your prompt or completion.", 'type': 'context_window_exceeded', 'param': 'messages', 'code': 'context_window_exceeded', 'solution': 'The input is too long for this model. Try reducing the length of your input or using a model with a larger context window. You can find models with different context lengths at https://chat.avalai.ir/platform/models'}}
2025-07-29 14:22:57,943 - __main__ - ERROR - An error occurred: Error code: 400 - {'error': {'message': "This model's maximum context length is exceeded. Please reduce the length of your prompt or completion.", 'type': 'context_window_exceeded', 'param': 'messages', 'code': 'context_window_exceeded', 'solution': 'The input is too long for this model. Try reducing the length of your input or using a model with a larger context window. You can find models with different context lengths at https://chat.avalai.ir/platform/models'}}
2025-07-29 14:22:57,947 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\rabieii.amin\Desktop\tender clustering\process_tenders.py", line 138, in main
    result_path = processor.process_excel(
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rabieii.amin\Desktop\tender clustering\src\processing\ai_processor.py", line 212, in process_excel
    tender_ids = self.filter_consulting_tenders(tenders_data)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rabieii.amin\Desktop\tender clustering\src\processing\ai_processor.py", line 150, in filter_consulting_tenders
    response = self.client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_utils\_utils.py", line 287, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\resources\chat\completions\completions.py", line 925, in create
    return self._post(
           ^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_base_client.py", line 1239, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_base_client.py", line 1034, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': "This model's maximum context length is exceeded. Please reduce the length of your prompt or completion.", 'type': 'context_window_exceeded', 'param': 'messages', 'code': 'context_window_exceeded', 'solution': 'The input is too long for this model. Try reducing the length of your input or using a model with a larger context window. You can find models with different context lengths at https://chat.avalai.ir/platform/models'}}

2025-07-29 14:25:19,986 - __main__ - INFO - Processing HTML files from C:\Users\rabieii.amin\Desktop\tender clustering\data\input
2025-07-29 14:25:19,986 - __main__ - INFO - Found 1 HTML files
2025-07-29 14:25:19,987 - __main__ - INFO - Parsing 2.html
2025-07-29 14:25:33,459 - __main__ - INFO - Saved tender information to C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\2_20250729_142533.xlsx
2025-07-29 14:25:33,459 - __main__ - INFO - Successfully processed 1 HTML files
2025-07-29 14:25:33,459 - __main__ - INFO - AI processing and email sending not yet implemented
2025-07-29 14:25:39,067 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-07-29 14:25:39,068 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\2_20250729_142533.xlsx
2025-07-29 14:25:39,068 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\2_20250729_142533.xlsx
2025-07-29 14:25:39,321 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250729_142539.xlsx
2025-07-29 14:25:39,505 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-07-29 14:25:39,505 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250729_142539.xlsx
2025-07-29 14:25:39,526 - src.processing.ai_processor - INFO - Filtering 301 tenders
2025-07-29 14:25:39,526 - src.processing.ai_processor - INFO - Sending request to language model
2025-07-29 14:25:45,910 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-07-29 14:25:45,918 - src.processing.ai_processor - INFO - Parsing language model response
2025-07-29 14:25:45,921 - src.processing.ai_processor - INFO - Found 13 consulting tenders
2025-07-29 14:25:45,925 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250729_142539.xlsx
2025-07-29 14:25:45,935 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\2_20250729_142533.xlsx
2025-07-29 14:25:45,987 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250729_142539.xlsx
2025-07-29 14:25:45,998 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250729_142539.xlsx
2025-07-29 14:25:45,999 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_2_20250729_142533.xlsx
2025-08-02 12:26:57,069 - __main__ - INFO - Preparing data from full_filtered_extracted_20250729_142539.xlsx
2025-08-02 12:26:57,547 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250802_122657.xlsx
2025-08-02 12:26:58,066 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-02 12:26:58,066 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250802_122657.xlsx
2025-08-02 12:26:58,075 - src.processing.ai_processor - INFO - Filtering 13 tenders
2025-08-02 12:26:58,076 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-02 12:27:00,892 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-02 12:27:00,906 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-02 12:27:00,907 - src.processing.ai_processor - INFO - Found 9 consulting tenders
2025-08-02 12:27:00,911 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250802_122657.xlsx
2025-08-02 12:27:00,922 - src.processing.ai_processor - INFO - Reading full data from: full_filtered_extracted_20250729_142539.xlsx
2025-08-02 12:27:00,929 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250802_122657.xlsx
2025-08-02 12:27:00,937 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250802_122657.xlsx
2025-08-02 12:27:00,937 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_full_filtered_extracted_20250729_142539.xlsx
2025-08-04 07:21:39,806 - __main__ - INFO - Processing HTML files from C:\Users\rabieii.amin\Desktop\tender clustering\data\input
2025-08-04 07:21:39,808 - __main__ - INFO - Found 1 HTML files
2025-08-04 07:21:39,809 - __main__ - INFO - Parsing 3.html
2025-08-04 07:22:00,537 - __main__ - INFO - Saved tender information to C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\3_20250804_072200.xlsx
2025-08-04 07:22:00,537 - __main__ - INFO - Successfully processed 1 HTML files
2025-08-04 07:22:00,537 - __main__ - INFO - AI processing and email sending not yet implemented
2025-08-04 07:22:44,271 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-04 07:22:44,271 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\3_20250804_072200.xlsx
2025-08-04 07:22:44,272 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\3_20250804_072200.xlsx
2025-08-04 07:22:44,623 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250804_072244.xlsx
2025-08-04 07:22:45,090 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-04 07:22:45,091 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250804_072244.xlsx
2025-08-04 07:22:45,130 - src.processing.ai_processor - INFO - Filtering 447 tenders
2025-08-04 07:22:45,132 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-04 07:22:51,328 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-04 07:22:51,333 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-04 07:22:51,335 - src.processing.ai_processor - INFO - Found 18 consulting tenders
2025-08-04 07:22:51,338 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250804_072244.xlsx
2025-08-04 07:22:51,353 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\3_20250804_072200.xlsx
2025-08-04 07:22:51,429 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250804_072244.xlsx
2025-08-04 07:22:51,448 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250804_072244.xlsx
2025-08-04 07:22:51,448 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_3_20250804_072200.xlsx
2025-08-05 14:31:05,965 - __main__ - INFO - Processing HTML files from C:\Users\rabieii.amin\Desktop\tender clustering\data\input
2025-08-05 14:31:05,965 - __main__ - INFO - Found 1 HTML files
2025-08-05 14:31:05,966 - __main__ - INFO - Parsing 4 (2).html
2025-08-05 14:31:29,300 - __main__ - INFO - Saved tender information to C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_143129.xlsx
2025-08-05 14:31:29,300 - __main__ - INFO - Successfully processed 1 HTML files
2025-08-05 14:31:29,301 - __main__ - INFO - AI processing and email sending not yet implemented
2025-08-05 14:31:44,402 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-05 14:31:44,403 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_143129.xlsx
2025-08-05 14:31:44,403 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_143129.xlsx
2025-08-05 14:31:44,739 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_143144.xlsx
2025-08-05 14:31:44,929 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-05 14:31:44,929 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_143144.xlsx
2025-08-05 14:31:44,968 - src.processing.ai_processor - INFO - Filtering 489 tenders
2025-08-05 14:31:44,969 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-05 14:31:53,076 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-05 14:31:53,079 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-05 14:31:53,080 - src.processing.ai_processor - INFO - Found 40 consulting tenders
2025-08-05 14:31:53,084 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_143144.xlsx
2025-08-05 14:31:53,100 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_143129.xlsx
2025-08-05 14:31:53,182 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250805_143144.xlsx
2025-08-05 14:31:53,205 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_143144.xlsx
2025-08-05 14:31:53,205 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_4 (2)_20250805_143129.xlsx
2025-08-05 15:26:23,127 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-05 15:26:23,128 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_143129.xlsx
2025-08-05 15:26:23,128 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_143129.xlsx
2025-08-05 15:26:23,461 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_152623.xlsx
2025-08-05 15:26:23,654 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-05 15:26:23,654 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_152623.xlsx
2025-08-05 15:26:23,693 - src.processing.ai_processor - INFO - Filtering 489 tenders
2025-08-05 15:26:23,695 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-05 15:26:33,794 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-05 15:26:33,797 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-05 15:26:33,797 - src.processing.ai_processor - INFO - Found 31 consulting tenders
2025-08-05 15:26:33,798 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_152623.xlsx
2025-08-05 15:26:33,815 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_143129.xlsx
2025-08-05 15:26:33,898 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250805_152623.xlsx
2025-08-05 15:26:33,919 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_152623.xlsx
2025-08-05 15:26:33,920 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_4 (2)_20250805_143129.xlsx
2025-08-05 15:29:57,723 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-05 15:29:57,724 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\~$4 (2)_20250805_143129.xlsx
2025-08-05 15:29:57,725 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\~$4 (2)_20250805_143129.xlsx
2025-08-05 15:29:57,726 - __main__ - ERROR - Error preparing data: [Errno 13] Permission denied: 'C:\\Users\\rabieii.amin\\Desktop\\tender clustering\\data\\processed\\~$4 (2)_20250805_143129.xlsx'
2025-08-05 15:29:57,726 - __main__ - ERROR - An error occurred: [Errno 13] Permission denied: 'C:\\Users\\rabieii.amin\\Desktop\\tender clustering\\data\\processed\\~$4 (2)_20250805_143129.xlsx'
2025-08-05 15:29:57,729 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\rabieii.amin\Desktop\tender clustering\process_tenders.py", line 120, in main
    extracted_path = prepare_data_for_ai(input_path, extracted_data_path)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rabieii.amin\Desktop\tender clustering\process_tenders.py", line 44, in prepare_data_for_ai
    df = pd.read_excel(input_path)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\pandas\io\excel\_base.py", line 495, in read_excel
    io = ExcelFile(
         ^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\pandas\io\excel\_base.py", line 1550, in __init__
    ext = inspect_excel_format(
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\pandas\io\excel\_base.py", line 1402, in inspect_excel_format
    with get_handle(
         ^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'C:\\Users\\rabieii.amin\\Desktop\\tender clustering\\data\\processed\\~$4 (2)_20250805_143129.xlsx'

2025-08-05 15:31:33,171 - __main__ - INFO - Processing HTML files from C:\Users\rabieii.amin\Desktop\tender clustering\data\input
2025-08-05 15:31:33,172 - __main__ - INFO - Found 1 HTML files
2025-08-05 15:31:33,172 - __main__ - INFO - Parsing 4 (2).html
2025-08-05 15:31:56,574 - __main__ - INFO - Saved tender information to C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:31:57,256 - __main__ - INFO - Successfully processed 1 HTML files
2025-08-05 15:31:57,261 - __main__ - INFO - AI processing and email sending not yet implemented
2025-08-05 15:32:05,351 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-05 15:32:05,352 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:32:05,352 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:32:05,682 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_153205.xlsx
2025-08-05 15:32:05,872 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-05 15:32:05,872 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_153205.xlsx
2025-08-05 15:32:05,911 - src.processing.ai_processor - INFO - Filtering 489 tenders
2025-08-05 15:32:05,912 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-05 15:32:15,806 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-05 15:32:15,809 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-05 15:32:15,809 - src.processing.ai_processor - INFO - Found 44 consulting tenders
2025-08-05 15:32:15,810 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_153205.xlsx
2025-08-05 15:32:15,828 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:32:15,912 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250805_153205.xlsx
2025-08-05 15:32:15,937 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_153205.xlsx
2025-08-05 15:32:15,938 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_4 (2)_20250805_153156.xlsx
2025-08-05 15:33:37,225 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-05 15:33:37,225 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:33:37,226 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:33:37,555 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_153337.xlsx
2025-08-05 15:33:37,747 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-05 15:33:37,747 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_153337.xlsx
2025-08-05 15:33:37,787 - src.processing.ai_processor - INFO - Filtering 489 tenders
2025-08-05 15:33:37,788 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-05 15:33:44,723 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-05 15:33:44,726 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-05 15:33:44,726 - src.processing.ai_processor - INFO - Found 46 consulting tenders
2025-08-05 15:33:44,727 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_153337.xlsx
2025-08-05 15:33:44,745 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:33:44,827 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250805_153337.xlsx
2025-08-05 15:33:44,852 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_153337.xlsx
2025-08-05 15:33:44,852 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_4 (2)_20250805_153156.xlsx
2025-08-05 15:35:11,923 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-05 15:35:11,924 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:35:11,924 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:35:12,243 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_153511.xlsx
2025-08-05 15:35:12,435 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-05 15:35:12,435 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_153511.xlsx
2025-08-05 15:35:12,473 - src.processing.ai_processor - INFO - Filtering 489 tenders
2025-08-05 15:35:12,475 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-05 15:35:19,853 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-05 15:35:19,857 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-05 15:35:19,857 - src.processing.ai_processor - INFO - Found 42 consulting tenders
2025-08-05 15:35:19,858 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_153511.xlsx
2025-08-05 15:35:19,875 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:35:19,956 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250805_153511.xlsx
2025-08-05 15:35:19,980 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_153511.xlsx
2025-08-05 15:35:19,980 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_4 (2)_20250805_153156.xlsx
2025-08-05 15:38:39,116 - __main__ - INFO - Preparing data from 4 (2)_20250805_153156.xlsx
2025-08-05 15:38:39,451 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_153839.xlsx
2025-08-05 15:38:39,640 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-05 15:38:39,641 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_153839.xlsx
2025-08-05 15:38:39,679 - src.processing.ai_processor - INFO - Filtering 489 tenders
2025-08-05 15:38:39,681 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-05 15:38:46,414 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-05 15:38:46,418 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-05 15:38:46,418 - src.processing.ai_processor - INFO - Found 26 consulting tenders
2025-08-05 15:38:46,419 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_153839.xlsx
2025-08-05 15:38:46,434 - src.processing.ai_processor - INFO - Reading full data from: 4 (2)_20250805_153156.xlsx
2025-08-05 15:38:46,517 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250805_153839.xlsx
2025-08-05 15:38:46,537 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_153839.xlsx
2025-08-05 15:38:46,537 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_4 (2)_20250805_153156.xlsx
2025-08-05 15:40:08,376 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-05 15:40:08,376 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:40:08,377 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:40:08,702 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_154008.xlsx
2025-08-05 15:40:08,895 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-05 15:40:08,895 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_154008.xlsx
2025-08-05 15:40:08,935 - src.processing.ai_processor - INFO - Filtering 489 tenders
2025-08-05 15:40:08,936 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-05 15:40:41,343 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 504 Gateway Time-out"
2025-08-05 15:40:41,345 - openai._base_client - INFO - Retrying request to /chat/completions in 0.482238 seconds
2025-08-05 15:40:47,560 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-05 15:40:47,563 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-05 15:40:47,563 - src.processing.ai_processor - INFO - Found 39 consulting tenders
2025-08-05 15:40:47,564 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_154008.xlsx
2025-08-05 15:40:47,581 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:40:47,665 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250805_154008.xlsx
2025-08-05 15:40:47,688 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_154008.xlsx
2025-08-05 15:40:47,688 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_4 (2)_20250805_153156.xlsx
2025-08-05 15:42:38,415 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-05 15:42:38,415 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:42:38,416 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:42:38,737 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_154238.xlsx
2025-08-05 15:42:38,928 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-05 15:42:38,929 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_154238.xlsx
2025-08-05 15:43:18,623 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-05 15:43:18,624 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:43:18,624 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:43:18,943 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_154318.xlsx
2025-08-05 15:43:19,133 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-05 15:43:19,133 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_154318.xlsx
2025-08-05 15:43:19,171 - src.processing.ai_processor - INFO - Filtering 489 tenders
2025-08-05 15:43:19,172 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-05 15:43:27,595 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-05 15:43:27,597 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-05 15:43:27,598 - src.processing.ai_processor - INFO - Found 10 consulting tenders
2025-08-05 15:43:27,599 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_154318.xlsx
2025-08-05 15:43:27,613 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:43:27,696 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250805_154318.xlsx
2025-08-05 15:43:27,714 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_154318.xlsx
2025-08-05 15:43:27,714 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_4 (2)_20250805_153156.xlsx
2025-08-05 15:45:16,457 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-05 15:45:16,457 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:45:16,458 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:45:16,789 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_154516.xlsx
2025-08-05 15:45:16,980 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-05 15:45:16,981 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_154516.xlsx
2025-08-05 15:45:17,020 - src.processing.ai_processor - INFO - Filtering 489 tenders
2025-08-05 15:45:17,022 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-05 15:46:00,404 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-05 15:46:00,407 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-05 15:46:00,407 - src.processing.ai_processor - INFO - Found 448 consulting tenders
2025-08-05 15:46:00,409 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_154516.xlsx
2025-08-05 15:46:00,461 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:46:00,544 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250805_154516.xlsx
2025-08-05 15:46:00,651 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_154516.xlsx
2025-08-05 15:46:00,651 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_4 (2)_20250805_153156.xlsx
2025-08-05 15:47:10,913 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-05 15:47:10,914 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:47:10,914 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:47:11,258 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_154710.xlsx
2025-08-05 15:47:11,451 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-05 15:47:11,451 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_154710.xlsx
2025-08-05 15:47:11,491 - src.processing.ai_processor - INFO - Filtering 489 tenders
2025-08-05 15:47:11,493 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-05 15:47:18,133 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-05 15:47:18,136 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-05 15:47:18,136 - src.processing.ai_processor - INFO - Found 30 consulting tenders
2025-08-05 15:47:18,137 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_154710.xlsx
2025-08-05 15:47:18,154 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:47:18,237 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250805_154710.xlsx
2025-08-05 15:47:18,258 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_154710.xlsx
2025-08-05 15:47:18,259 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_4 (2)_20250805_153156.xlsx
2025-08-05 15:48:24,570 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-05 15:48:24,571 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:48:24,571 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:48:24,910 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_154824.xlsx
2025-08-05 15:48:25,109 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-05 15:48:25,109 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_154824.xlsx
2025-08-05 15:48:25,149 - src.processing.ai_processor - INFO - Filtering 489 tenders
2025-08-05 15:48:25,150 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-05 15:48:33,061 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-05 15:48:33,064 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-05 15:48:33,064 - src.processing.ai_processor - INFO - Found 31 consulting tenders
2025-08-05 15:48:33,065 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_154824.xlsx
2025-08-05 15:48:33,082 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:48:33,165 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250805_154824.xlsx
2025-08-05 15:48:33,186 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_154824.xlsx
2025-08-05 15:48:33,186 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_4 (2)_20250805_153156.xlsx
2025-08-05 15:54:28,491 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-05 15:54:28,491 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:54:28,492 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:54:28,876 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_155428.xlsx
2025-08-05 15:54:29,097 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-05 15:54:29,097 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250805_155428.xlsx
2025-08-05 15:54:29,141 - src.processing.ai_processor - INFO - Filtering 489 tenders
2025-08-05 15:54:29,142 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-05 15:54:36,892 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-05 15:54:36,895 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-05 15:54:36,895 - src.processing.ai_processor - INFO - Found 38 consulting tenders
2025-08-05 15:54:36,897 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_155428.xlsx
2025-08-05 15:54:36,914 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-05 15:54:37,000 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250805_155428.xlsx
2025-08-05 15:54:37,024 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250805_155428.xlsx
2025-08-05 15:54:37,024 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_4 (2)_20250805_153156.xlsx
2025-08-09 08:26:15,518 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 08:26:15,519 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:26:15,519 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:26:15,878 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_082615.xlsx
2025-08-09 08:26:16,390 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 08:26:16,390 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_082615.xlsx
2025-08-09 08:26:16,430 - src.processing.ai_processor - INFO - Filtering 489 tenders
2025-08-09 08:26:16,431 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 08:26:28,180 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-09 08:26:28,185 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-09 08:26:28,185 - src.processing.ai_processor - INFO - Found 40 consulting tenders
2025-08-09 08:26:28,186 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_082615.xlsx
2025-08-09 08:26:28,204 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:26:28,286 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250809_082615.xlsx
2025-08-09 08:26:28,310 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_082615.xlsx
2025-08-09 08:26:28,310 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_4 (2)_20250805_153156.xlsx
2025-08-09 08:29:55,774 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 08:29:55,775 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:29:55,775 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:29:56,099 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_082955.xlsx
2025-08-09 08:29:56,611 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 08:29:56,611 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_082955.xlsx
2025-08-09 08:29:56,651 - src.processing.ai_processor - INFO - Filtering 489 tenders
2025-08-09 08:29:56,652 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 08:30:02,624 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-08-09 08:30:02,626 - openai._base_client - INFO - Retrying request to /chat/completions in 0.423489 seconds
2025-08-09 08:30:07,907 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-08-09 08:30:07,909 - openai._base_client - INFO - Retrying request to /chat/completions in 0.898354 seconds
2025-08-09 08:30:13,450 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-08-09 08:30:13,455 - src.processing.ai_processor - ERROR - Error filtering consulting tenders: Error code: 429 - {'error': {'message': 'You have insufficient credit to complete this request. Your remaining balance of 0.45506409 UNIT(s) does not cover the estimated cost.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota', 'solution': 'Please check your credit balance at https://chat.avalai.ir/platform/billing. You may need to add more credits to continue using the service.'}}
2025-08-09 08:30:13,455 - src.processing.ai_processor - ERROR - Error processing Excel file: Error code: 429 - {'error': {'message': 'You have insufficient credit to complete this request. Your remaining balance of 0.45506409 UNIT(s) does not cover the estimated cost.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota', 'solution': 'Please check your credit balance at https://chat.avalai.ir/platform/billing. You may need to add more credits to continue using the service.'}}
2025-08-09 08:30:13,457 - __main__ - ERROR - An error occurred: Error code: 429 - {'error': {'message': 'You have insufficient credit to complete this request. Your remaining balance of 0.45506409 UNIT(s) does not cover the estimated cost.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota', 'solution': 'Please check your credit balance at https://chat.avalai.ir/platform/billing. You may need to add more credits to continue using the service.'}}
2025-08-09 08:30:13,470 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\rabieii.amin\Desktop\tender clustering\process_tenders.py", line 138, in main
    result_path = processor.process_excel(
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rabieii.amin\Desktop\tender clustering\src\processing\ai_processor.py", line 214, in process_excel
    tender_ids = self.filter_consulting_tenders(tenders_data)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rabieii.amin\Desktop\tender clustering\src\processing\ai_processor.py", line 152, in filter_consulting_tenders
    response = self.client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_utils\_utils.py", line 287, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\resources\chat\completions\completions.py", line 925, in create
    return self._post(
           ^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_base_client.py", line 1239, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_base_client.py", line 1034, in request
    raise self._make_status_error_from_response(err.response) from None
openai.RateLimitError: Error code: 429 - {'error': {'message': 'You have insufficient credit to complete this request. Your remaining balance of 0.45506409 UNIT(s) does not cover the estimated cost.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota', 'solution': 'Please check your credit balance at https://chat.avalai.ir/platform/billing. You may need to add more credits to continue using the service.'}}

2025-08-09 08:30:27,218 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 08:30:27,219 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:30:27,220 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:30:27,544 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_083027.xlsx
2025-08-09 08:30:28,053 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 08:30:28,053 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_083027.xlsx
2025-08-09 08:30:28,095 - src.processing.ai_processor - INFO - Filtering 489 tenders
2025-08-09 08:30:28,096 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 08:30:33,282 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-08-09 08:30:33,283 - openai._base_client - INFO - Retrying request to /chat/completions in 0.411509 seconds
2025-08-09 08:30:37,450 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-08-09 08:30:37,451 - openai._base_client - INFO - Retrying request to /chat/completions in 0.960186 seconds
2025-08-09 08:30:43,210 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-08-09 08:30:43,213 - src.processing.ai_processor - ERROR - Error filtering consulting tenders: Error code: 429 - {'error': {'message': 'You have insufficient credit to complete this request. Your remaining balance of 0.45506409 UNIT(s) does not cover the estimated cost.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota', 'solution': 'Please check your credit balance at https://chat.avalai.ir/platform/billing. You may need to add more credits to continue using the service.'}}
2025-08-09 08:30:43,214 - src.processing.ai_processor - ERROR - Error processing Excel file: Error code: 429 - {'error': {'message': 'You have insufficient credit to complete this request. Your remaining balance of 0.45506409 UNIT(s) does not cover the estimated cost.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota', 'solution': 'Please check your credit balance at https://chat.avalai.ir/platform/billing. You may need to add more credits to continue using the service.'}}
2025-08-09 08:30:43,214 - __main__ - ERROR - An error occurred: Error code: 429 - {'error': {'message': 'You have insufficient credit to complete this request. Your remaining balance of 0.45506409 UNIT(s) does not cover the estimated cost.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota', 'solution': 'Please check your credit balance at https://chat.avalai.ir/platform/billing. You may need to add more credits to continue using the service.'}}
2025-08-09 08:30:43,220 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\rabieii.amin\Desktop\tender clustering\process_tenders.py", line 138, in main
    result_path = processor.process_excel(
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rabieii.amin\Desktop\tender clustering\src\processing\ai_processor.py", line 214, in process_excel
    tender_ids = self.filter_consulting_tenders(tenders_data)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rabieii.amin\Desktop\tender clustering\src\processing\ai_processor.py", line 152, in filter_consulting_tenders
    response = self.client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_utils\_utils.py", line 287, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\resources\chat\completions\completions.py", line 925, in create
    return self._post(
           ^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_base_client.py", line 1239, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_base_client.py", line 1034, in request
    raise self._make_status_error_from_response(err.response) from None
openai.RateLimitError: Error code: 429 - {'error': {'message': 'You have insufficient credit to complete this request. Your remaining balance of 0.45506409 UNIT(s) does not cover the estimated cost.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota', 'solution': 'Please check your credit balance at https://chat.avalai.ir/platform/billing. You may need to add more credits to continue using the service.'}}

2025-08-09 08:31:00,263 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 08:31:00,264 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:31:00,264 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:31:00,586 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_083100.xlsx
2025-08-09 08:31:01,095 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 08:31:01,096 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_083100.xlsx
2025-08-09 08:31:01,134 - src.processing.ai_processor - INFO - Filtering 489 tenders
2025-08-09 08:31:01,135 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 08:31:06,092 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-08-09 08:31:06,093 - openai._base_client - INFO - Retrying request to /chat/completions in 0.478860 seconds
2025-08-09 08:31:09,930 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-08-09 08:31:09,931 - openai._base_client - INFO - Retrying request to /chat/completions in 0.768717 seconds
2025-08-09 08:31:13,778 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-08-09 08:31:13,780 - src.processing.ai_processor - ERROR - Error filtering consulting tenders: Error code: 429 - {'error': {'message': 'You have insufficient credit to complete this request. Your remaining balance of 0.45506409 UNIT(s) does not cover the estimated cost.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota', 'solution': 'Please check your credit balance at https://chat.avalai.ir/platform/billing. You may need to add more credits to continue using the service.'}}
2025-08-09 08:31:13,781 - src.processing.ai_processor - ERROR - Error processing Excel file: Error code: 429 - {'error': {'message': 'You have insufficient credit to complete this request. Your remaining balance of 0.45506409 UNIT(s) does not cover the estimated cost.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota', 'solution': 'Please check your credit balance at https://chat.avalai.ir/platform/billing. You may need to add more credits to continue using the service.'}}
2025-08-09 08:31:13,781 - __main__ - ERROR - An error occurred: Error code: 429 - {'error': {'message': 'You have insufficient credit to complete this request. Your remaining balance of 0.45506409 UNIT(s) does not cover the estimated cost.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota', 'solution': 'Please check your credit balance at https://chat.avalai.ir/platform/billing. You may need to add more credits to continue using the service.'}}
2025-08-09 08:31:13,793 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\rabieii.amin\Desktop\tender clustering\process_tenders.py", line 138, in main
    result_path = processor.process_excel(
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rabieii.amin\Desktop\tender clustering\src\processing\ai_processor.py", line 214, in process_excel
    tender_ids = self.filter_consulting_tenders(tenders_data)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rabieii.amin\Desktop\tender clustering\src\processing\ai_processor.py", line 152, in filter_consulting_tenders
    response = self.client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_utils\_utils.py", line 287, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\resources\chat\completions\completions.py", line 925, in create
    return self._post(
           ^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_base_client.py", line 1239, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_base_client.py", line 1034, in request
    raise self._make_status_error_from_response(err.response) from None
openai.RateLimitError: Error code: 429 - {'error': {'message': 'You have insufficient credit to complete this request. Your remaining balance of 0.45506409 UNIT(s) does not cover the estimated cost.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota', 'solution': 'Please check your credit balance at https://chat.avalai.ir/platform/billing. You may need to add more credits to continue using the service.'}}

2025-08-09 08:33:07,832 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 08:33:07,832 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:33:07,833 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:33:08,156 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_083307.xlsx
2025-08-09 08:33:08,667 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 08:33:08,667 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_083307.xlsx
2025-08-09 08:33:08,707 - src.processing.ai_processor - INFO - Filtering 489 tenders
2025-08-09 08:33:08,708 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 08:33:18,428 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-08-09 08:33:18,430 - openai._base_client - INFO - Retrying request to /chat/completions in 0.426814 seconds
2025-08-09 08:33:23,705 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-08-09 08:33:23,706 - openai._base_client - INFO - Retrying request to /chat/completions in 0.772057 seconds
2025-08-09 08:33:28,763 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-08-09 08:33:28,766 - src.processing.ai_processor - ERROR - Error filtering consulting tenders: Error code: 429 - {'error': {'message': 'You have insufficient credit to complete this request. Your remaining balance of 0.45506409 UNIT(s) does not cover the estimated cost.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota', 'solution': 'Please check your credit balance at https://chat.avalai.ir/platform/billing. You may need to add more credits to continue using the service.'}}
2025-08-09 08:33:28,766 - src.processing.ai_processor - ERROR - Error processing Excel file: Error code: 429 - {'error': {'message': 'You have insufficient credit to complete this request. Your remaining balance of 0.45506409 UNIT(s) does not cover the estimated cost.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota', 'solution': 'Please check your credit balance at https://chat.avalai.ir/platform/billing. You may need to add more credits to continue using the service.'}}
2025-08-09 08:33:28,768 - __main__ - ERROR - An error occurred: Error code: 429 - {'error': {'message': 'You have insufficient credit to complete this request. Your remaining balance of 0.45506409 UNIT(s) does not cover the estimated cost.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota', 'solution': 'Please check your credit balance at https://chat.avalai.ir/platform/billing. You may need to add more credits to continue using the service.'}}
2025-08-09 08:33:28,776 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\rabieii.amin\Desktop\tender clustering\process_tenders.py", line 138, in main
    result_path = processor.process_excel(
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rabieii.amin\Desktop\tender clustering\src\processing\ai_processor.py", line 214, in process_excel
    tender_ids = self.filter_consulting_tenders(tenders_data)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rabieii.amin\Desktop\tender clustering\src\processing\ai_processor.py", line 152, in filter_consulting_tenders
    response = self.client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_utils\_utils.py", line 287, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\resources\chat\completions\completions.py", line 925, in create
    return self._post(
           ^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_base_client.py", line 1239, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_base_client.py", line 1034, in request
    raise self._make_status_error_from_response(err.response) from None
openai.RateLimitError: Error code: 429 - {'error': {'message': 'You have insufficient credit to complete this request. Your remaining balance of 0.45506409 UNIT(s) does not cover the estimated cost.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota', 'solution': 'Please check your credit balance at https://chat.avalai.ir/platform/billing. You may need to add more credits to continue using the service.'}}

2025-08-09 08:45:28,434 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 08:45:28,434 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:45:28,435 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:45:28,759 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_084528.xlsx
2025-08-09 08:45:28,970 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 08:45:28,971 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_084528.xlsx
2025-08-09 08:45:29,011 - src.processing.ai_processor - INFO - Filtering 489 tenders
2025-08-09 08:45:29,012 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 08:45:35,699 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-09 08:45:35,711 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-09 08:45:35,711 - src.processing.ai_processor - INFO - Found 40 consulting tenders
2025-08-09 08:45:35,712 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_084528.xlsx
2025-08-09 08:45:35,730 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:45:35,811 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250809_084528.xlsx
2025-08-09 08:45:35,836 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_084528.xlsx
2025-08-09 08:45:35,836 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_4 (2)_20250805_153156.xlsx
2025-08-09 08:46:53,355 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 08:46:53,355 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:46:53,355 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:46:53,692 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_084653.xlsx
2025-08-09 08:46:53,902 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 08:46:53,903 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_084653.xlsx
2025-08-09 08:46:53,942 - src.processing.ai_processor - INFO - Filtering 489 tenders
2025-08-09 08:46:53,943 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 08:47:00,492 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-09 08:47:00,497 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-09 08:47:00,497 - src.processing.ai_processor - INFO - Found 40 consulting tenders
2025-08-09 08:47:00,498 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_084653.xlsx
2025-08-09 08:47:00,518 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:47:00,599 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250809_084653.xlsx
2025-08-09 08:47:00,624 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_084653.xlsx
2025-08-09 08:47:00,624 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_4 (2)_20250805_153156.xlsx
2025-08-09 08:47:44,922 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 08:47:44,923 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:47:44,923 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:47:45,249 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_084744.xlsx
2025-08-09 08:47:45,460 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 08:47:45,460 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_084744.xlsx
2025-08-09 08:47:45,499 - src.processing.ai_processor - INFO - Filtering 489 tenders
2025-08-09 08:47:45,499 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 08:47:52,183 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-09 08:47:52,186 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-09 08:47:52,186 - src.processing.ai_processor - INFO - Found 38 consulting tenders
2025-08-09 08:47:52,187 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_084744.xlsx
2025-08-09 08:47:52,205 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:47:52,286 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250809_084744.xlsx
2025-08-09 08:47:52,310 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_084744.xlsx
2025-08-09 08:47:52,310 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_4 (2)_20250805_153156.xlsx
2025-08-09 08:48:58,321 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 08:48:58,321 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:48:58,321 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:48:58,651 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_084858.xlsx
2025-08-09 08:48:58,867 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 08:48:58,867 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_084858.xlsx
2025-08-09 08:48:58,906 - src.processing.ai_processor - INFO - Filtering 489 tenders
2025-08-09 08:48:58,908 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 08:49:04,982 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1\/chat/completions "HTTP/1.1 200 OK"
2025-08-09 08:49:04,987 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-09 08:49:04,987 - src.processing.ai_processor - INFO - Found 38 consulting tenders
2025-08-09 08:49:04,988 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_084858.xlsx
2025-08-09 08:49:05,007 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:49:05,089 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250809_084858.xlsx
2025-08-09 08:49:05,112 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_084858.xlsx
2025-08-09 08:49:05,113 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_4 (2)_20250805_153156.xlsx
2025-08-09 08:49:38,701 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 08:49:38,702 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:49:38,702 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:49:39,028 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_084938.xlsx
2025-08-09 08:49:39,238 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 08:49:39,238 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_084938.xlsx
2025-08-09 08:49:39,277 - src.processing.ai_processor - INFO - Filtering 489 tenders
2025-08-09 08:49:39,279 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 08:49:42,558 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-09 08:49:42,567 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-09 08:49:42,567 - src.processing.ai_processor - INFO - Found 42 consulting tenders
2025-08-09 08:49:42,569 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_084938.xlsx
2025-08-09 08:49:42,587 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\4 (2)_20250805_153156.xlsx
2025-08-09 08:49:42,668 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250809_084938.xlsx
2025-08-09 08:49:42,692 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_084938.xlsx
2025-08-09 08:49:42,693 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_4 (2)_20250805_153156.xlsx
2025-08-09 08:55:18,318 - __main__ - INFO - Processing HTML files from C:\Users\rabieii.amin\Desktop\tender clustering\data\input
2025-08-09 08:55:18,318 - __main__ - INFO - Found 1 HTML files
2025-08-09 08:55:18,318 - __main__ - INFO - Parsing 234.html
2025-08-09 08:55:35,177 - __main__ - INFO - Saved tender information to C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\234_20250809_085534.xlsx
2025-08-09 08:55:35,177 - __main__ - INFO - Successfully processed 1 HTML files
2025-08-09 08:55:35,177 - __main__ - INFO - AI processing and email sending not yet implemented
2025-08-09 09:05:22,298 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 09:05:22,299 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\~$234_20250809_085534.xlsx
2025-08-09 09:05:22,299 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\~$234_20250809_085534.xlsx
2025-08-09 09:05:22,299 - __main__ - ERROR - Error preparing data: [Errno 13] Permission denied: 'C:\\Users\\rabieii.amin\\Desktop\\tender clustering\\data\\processed\\~$234_20250809_085534.xlsx'
2025-08-09 09:05:22,299 - __main__ - ERROR - An error occurred: [Errno 13] Permission denied: 'C:\\Users\\rabieii.amin\\Desktop\\tender clustering\\data\\processed\\~$234_20250809_085534.xlsx'
2025-08-09 09:05:22,305 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\rabieii.amin\Desktop\tender clustering\process_tenders.py", line 120, in main
    extracted_path = prepare_data_for_ai(input_path, extracted_data_path)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rabieii.amin\Desktop\tender clustering\process_tenders.py", line 44, in prepare_data_for_ai
    df = pd.read_excel(input_path)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\pandas\io\excel\_base.py", line 495, in read_excel
    io = ExcelFile(
         ^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\pandas\io\excel\_base.py", line 1550, in __init__
    ext = inspect_excel_format(
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\pandas\io\excel\_base.py", line 1402, in inspect_excel_format
    with get_handle(
         ^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'C:\\Users\\rabieii.amin\\Desktop\\tender clustering\\data\\processed\\~$234_20250809_085534.xlsx'

2025-08-09 09:05:36,319 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 09:05:36,319 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\~$234_20250809_085534.xlsx
2025-08-09 09:05:36,320 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\~$234_20250809_085534.xlsx
2025-08-09 09:05:36,320 - __main__ - ERROR - Error preparing data: [Errno 13] Permission denied: 'C:\\Users\\rabieii.amin\\Desktop\\tender clustering\\data\\processed\\~$234_20250809_085534.xlsx'
2025-08-09 09:05:36,320 - __main__ - ERROR - An error occurred: [Errno 13] Permission denied: 'C:\\Users\\rabieii.amin\\Desktop\\tender clustering\\data\\processed\\~$234_20250809_085534.xlsx'
2025-08-09 09:05:36,323 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\rabieii.amin\Desktop\tender clustering\process_tenders.py", line 120, in main
    extracted_path = prepare_data_for_ai(input_path, extracted_data_path)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rabieii.amin\Desktop\tender clustering\process_tenders.py", line 44, in prepare_data_for_ai
    df = pd.read_excel(input_path)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\pandas\io\excel\_base.py", line 495, in read_excel
    io = ExcelFile(
         ^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\pandas\io\excel\_base.py", line 1550, in __init__
    ext = inspect_excel_format(
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\pandas\io\excel\_base.py", line 1402, in inspect_excel_format
    with get_handle(
         ^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'C:\\Users\\rabieii.amin\\Desktop\\tender clustering\\data\\processed\\~$234_20250809_085534.xlsx'

2025-08-09 09:06:24,013 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 09:06:24,013 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\234_20250809_085534.xlsx
2025-08-09 09:06:24,013 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\234_20250809_085534.xlsx
2025-08-09 09:06:24,313 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_090624.xlsx
2025-08-09 09:06:24,521 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 09:06:24,521 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_090624.xlsx
2025-08-09 09:06:24,553 - src.processing.ai_processor - INFO - Filtering 378 tenders
2025-08-09 09:06:24,554 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 09:06:29,774 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-09 09:06:29,782 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-09 09:06:29,782 - src.processing.ai_processor - INFO - Found 38 consulting tenders
2025-08-09 09:06:29,783 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_090624.xlsx
2025-08-09 09:06:29,801 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\234_20250809_085534.xlsx
2025-08-09 09:06:29,866 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250809_090624.xlsx
2025-08-09 09:06:29,891 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_090624.xlsx
2025-08-09 09:06:29,891 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_234_20250809_085534.xlsx
2025-08-09 10:14:58,295 - __main__ - INFO - Processing HTML files from C:\Users\rabieii.amin\Desktop\tender clustering\data\input
2025-08-09 10:14:58,295 - __main__ - INFO - Found 1 HTML files
2025-08-09 10:14:58,295 - __main__ - INFO - Parsing 235.html
2025-08-09 10:15:23,581 - __main__ - INFO - Saved tender information to C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\235_20250809_101523.xlsx
2025-08-09 10:15:23,581 - __main__ - INFO - Successfully processed 1 HTML files
2025-08-09 10:15:23,581 - __main__ - INFO - AI processing and email sending not yet implemented
2025-08-09 10:16:49,052 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 10:16:49,053 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\235_20250809_101523.xlsx
2025-08-09 10:16:49,053 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\235_20250809_101523.xlsx
2025-08-09 10:16:49,403 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_101649.xlsx
2025-08-09 10:16:49,608 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 10:16:49,609 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_101649.xlsx
2025-08-09 10:16:49,651 - src.processing.ai_processor - INFO - Filtering 561 tenders
2025-08-09 10:16:49,652 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 10:16:57,989 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-09 10:16:57,997 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-09 10:16:57,997 - src.processing.ai_processor - INFO - Found 20 consulting tenders
2025-08-09 10:16:57,999 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_101649.xlsx
2025-08-09 10:16:58,017 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\235_20250809_101523.xlsx
2025-08-09 10:16:58,112 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250809_101649.xlsx
2025-08-09 10:16:58,132 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_101649.xlsx
2025-08-09 10:16:58,133 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_235_20250809_101523.xlsx
2025-08-09 13:26:04,118 - __main__ - INFO - Processing HTML files from C:\Users\rabieii.amin\Desktop\tender clustering\data\input
2025-08-09 13:26:04,119 - __main__ - INFO - Found 1 HTML files
2025-08-09 13:26:04,119 - __main__ - INFO - Parsing 236.html
2025-08-09 13:26:24,005 - __main__ - INFO - Saved tender information to C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_132623.xlsx
2025-08-09 13:26:24,005 - __main__ - INFO - Successfully processed 1 HTML files
2025-08-09 13:26:24,005 - __main__ - INFO - AI processing and email sending not yet implemented
2025-08-09 13:33:18,741 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 13:33:18,742 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_132623.xlsx
2025-08-09 13:33:18,742 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_132623.xlsx
2025-08-09 13:33:19,059 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_133318.xlsx
2025-08-09 13:33:19,270 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 13:33:19,270 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_133318.xlsx
2025-08-09 13:33:19,307 - src.processing.ai_processor - INFO - Filtering 447 tenders
2025-08-09 13:33:19,308 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 13:33:27,542 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-09 13:33:27,548 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-09 13:33:27,548 - src.processing.ai_processor - INFO - Found 18 consulting tenders
2025-08-09 13:33:27,549 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_133318.xlsx
2025-08-09 13:33:27,566 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_132623.xlsx
2025-08-09 13:33:27,640 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250809_133318.xlsx
2025-08-09 13:33:27,661 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_133318.xlsx
2025-08-09 13:33:27,661 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_236_20250809_132623.xlsx
2025-08-09 13:37:24,168 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 13:37:24,168 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_132623.xlsx
2025-08-09 13:37:24,168 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_132623.xlsx
2025-08-09 13:37:24,486 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_133724.xlsx
2025-08-09 13:37:24,694 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 13:37:24,694 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_133724.xlsx
2025-08-09 13:37:24,731 - src.processing.ai_processor - INFO - Filtering 447 tenders
2025-08-09 13:37:24,732 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 13:37:38,698 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-09 13:37:38,703 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-09 13:37:38,703 - src.processing.ai_processor - INFO - Found 18 consulting tenders
2025-08-09 13:37:38,704 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_133724.xlsx
2025-08-09 13:37:38,721 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_132623.xlsx
2025-08-09 13:37:38,796 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250809_133724.xlsx
2025-08-09 13:37:38,815 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_133724.xlsx
2025-08-09 13:37:38,815 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_236_20250809_132623.xlsx
2025-08-09 13:38:48,126 - __main__ - INFO - Processing HTML files from C:\Users\rabieii.amin\Desktop\tender clustering\data\input
2025-08-09 13:38:48,126 - __main__ - INFO - Found 1 HTML files
2025-08-09 13:38:48,126 - __main__ - INFO - Parsing 236.html
2025-08-09 13:39:08,096 - __main__ - INFO - Saved tender information to C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_133907.xlsx
2025-08-09 13:39:08,096 - __main__ - INFO - Successfully processed 1 HTML files
2025-08-09 13:39:08,096 - __main__ - INFO - AI processing and email sending not yet implemented
2025-08-09 13:39:15,101 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 13:39:15,102 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_133907.xlsx
2025-08-09 13:39:15,102 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_133907.xlsx
2025-08-09 13:39:15,431 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_133915.xlsx
2025-08-09 13:39:15,640 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 13:39:15,641 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_133915.xlsx
2025-08-09 13:39:15,678 - src.processing.ai_processor - INFO - Filtering 447 tenders
2025-08-09 13:39:15,679 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 13:39:23,785 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-09 13:39:23,790 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-09 13:39:23,790 - src.processing.ai_processor - INFO - Found 18 consulting tenders
2025-08-09 13:39:23,791 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_133915.xlsx
2025-08-09 13:39:23,808 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_133907.xlsx
2025-08-09 13:39:23,883 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250809_133915.xlsx
2025-08-09 13:39:23,903 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_133915.xlsx
2025-08-09 13:39:23,903 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_236_20250809_133907.xlsx
2025-08-09 13:56:56,305 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 13:56:56,305 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_133907.xlsx
2025-08-09 13:56:56,306 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_133907.xlsx
2025-08-09 13:56:56,621 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_135656.xlsx
2025-08-09 13:56:56,827 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 13:56:56,828 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_135656.xlsx
2025-08-09 13:56:56,865 - src.processing.ai_processor - INFO - Filtering 447 tenders
2025-08-09 13:56:56,865 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 13:57:37,840 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 522 "
2025-08-09 13:57:37,843 - openai._base_client - INFO - Retrying request to /chat/completions in 0.379891 seconds
2025-08-09 13:58:17,805 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 522 "
2025-08-09 13:58:17,810 - openai._base_client - INFO - Retrying request to /chat/completions in 0.866293 seconds
2025-08-09 13:58:58,230 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 522 "
2025-08-09 13:58:58,232 - src.processing.ai_processor - ERROR - Error filtering consulting tenders: <!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en-US"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en-US"> <!--<![endif]-->
<head>


<title>api.avalai.ir | 522: Connection timed out</title>
<meta charset="UTF-8" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta name="robots" content="noindex, nofollow" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<link rel="stylesheet" id="cf_styles-css" href="/cdn-cgi/styles/main.css" />


</head>
<body>
<div id="cf-wrapper">
    <div id="cf-error-details" class="p-0">
        <header class="mx-auto pt-10 lg:pt-6 lg:px-8 w-240 lg:w-full mb-8">
            <h1 class="inline-block sm:block sm:mb-2 font-light text-60 lg:text-4xl text-black-dark leading-tight mr-2">
              <span class="inline-block">Connection timed out</span>
              <span class="code-label">Error code 522</span>
            </h1>
            <div>
               Visit <a href="https://www.cloudflare.com/5xx-error-landing?utm_source=errorcode_522&utm_campaign=api.avalai.ir" target="_blank" rel="noopener noreferrer">cloudflare.com</a> for more information.
            </div>
            <div class="mt-3">2025-08-09 10:28:57 UTC</div>
        </header>
        <div class="my-8 bg-gradient-gray">
            <div class="w-240 lg:w-full mx-auto">
                <div class="clearfix md:px-8">
                  
<div id="cf-browser-status" class=" relative w-1/3 md:w-full py-15 md:p-0 md:py-8 md:text-left md:border-solid md:border-0 md:border-b md:border-gray-400 overflow-hidden float-left md:float-none text-center">
  <div class="relative mb-10 md:m-0">
    
    <span class="cf-icon-browser block md:hidden h-20 bg-center bg-no-repeat"></span>
    <span class="cf-icon-ok w-12 h-12 absolute left-1/2 md:left-auto md:right-0 md:top-0 -ml-6 -bottom-4"></span>
    
  </div>
  <span class="md:block w-full truncate">You</span>
  <h3 class="md:inline-block mt-3 md:mt-0 text-2xl text-gray-600 font-light leading-1.3">
    
    Browser
    
  </h3>
  <span class="leading-1.3 text-2xl text-green-success">Working</span>
</div>

<div id="cf-cloudflare-status" class=" relative w-1/3 md:w-full py-15 md:p-0 md:py-8 md:text-left md:border-solid md:border-0 md:border-b md:border-gray-400 overflow-hidden float-left md:float-none text-center">
  <div class="relative mb-10 md:m-0">
    <a href="https://www.cloudflare.com/5xx-error-landing?utm_source=errorcode_522&utm_campaign=api.avalai.ir" target="_blank" rel="noopener noreferrer">
    <span class="cf-icon-cloud block md:hidden h-20 bg-center bg-no-repeat"></span>
    <span class="cf-icon-ok w-12 h-12 absolute left-1/2 md:left-auto md:right-0 md:top-0 -ml-6 -bottom-4"></span>
    </a>
  </div>
  <span class="md:block w-full truncate">Frankfurt</span>
  <h3 class="md:inline-block mt-3 md:mt-0 text-2xl text-gray-600 font-light leading-1.3">
    <a href="https://www.cloudflare.com/5xx-error-landing?utm_source=errorcode_522&utm_campaign=api.avalai.ir" target="_blank" rel="noopener noreferrer">
    Cloudflare
    </a>
  </h3>
  <span class="leading-1.3 text-2xl text-green-success">Working</span>
</div>

<div id="cf-host-status" class="cf-error-source relative w-1/3 md:w-full py-15 md:p-0 md:py-8 md:text-left md:border-solid md:border-0 md:border-b md:border-gray-400 overflow-hidden float-left md:float-none text-center">
  <div class="relative mb-10 md:m-0">
    
    <span class="cf-icon-server block md:hidden h-20 bg-center bg-no-repeat"></span>
    <span class="cf-icon-error w-12 h-12 absolute left-1/2 md:left-auto md:right-0 md:top-0 -ml-6 -bottom-4"></span>
    
  </div>
  <span class="md:block w-full truncate">api.avalai.ir</span>
  <h3 class="md:inline-block mt-3 md:mt-0 text-2xl text-gray-600 font-light leading-1.3">
    
    Host
    
  </h3>
  <span class="leading-1.3 text-2xl text-red-error">Error</span>
</div>

                </div>
            </div>
        </div>

        <div class="w-240 lg:w-full mx-auto mb-8 lg:px-8">
            <div class="clearfix">
                <div class="w-1/2 md:w-full float-left pr-6 md:pb-10 md:pr-0 leading-relaxed">
                    <h2 class="text-3xl font-normal leading-1.3 mb-4">What happened?</h2>
                    <p>The initial connection between Cloudflare's network and the origin web server timed out. As a result, the web page can not be displayed.</p>
                </div>
                <div class="w-1/2 md:w-full float-left leading-relaxed">
                    <h2 class="text-3xl font-normal leading-1.3 mb-4">What can I do?</h2>
                          <h3 class="text-15 font-semibold mb-2">If you're a visitor of this website:</h3>
      <p class="mb-6">Please try again in a few minutes.</p>

      <h3 class="text-15 font-semibold mb-2">If you're the owner of this website:</h3>
      <p><span>Contact your hosting provider letting them know your web server is not completing requests. An Error 522 means that the request was able to connect to your web server, but that the request didn't finish. The most likely cause is that something on your server is hogging resources.</span> <a rel="noopener noreferrer" href="https://developers.cloudflare.com/support/troubleshooting/http-status-codes/cloudflare-5xx-errors/error-522/">Additional troubleshooting information here.</a></p>
                </div>
            </div>
        </div>

        <div class="cf-error-footer cf-wrapper w-240 lg:w-full py-10 sm:py-4 sm:px-8 mx-auto text-center sm:text-left border-solid border-0 border-t border-gray-300">
  <p class="text-13">
    <span class="cf-footer-item sm:block sm:mb-1">Cloudflare Ray ID: <strong class="font-semibold">96c690df5f7f613b</strong></span>
    <span class="cf-footer-separator sm:hidden">&bull;</span>
    <span id="cf-footer-item-ip" class="cf-footer-item hidden sm:block sm:mb-1">
      Your IP:
      <button type="button" id="cf-footer-ip-reveal" class="cf-footer-ip-reveal-btn">Click to reveal</button>
      <span class="hidden" id="cf-footer-ip">178.131.162.24</span>
      <span class="cf-footer-separator sm:hidden">&bull;</span>
    </span>
    <span class="cf-footer-item sm:block sm:mb-1"><span>Performance &amp; security by</span> <a rel="noopener noreferrer" href="https://www.cloudflare.com/5xx-error-landing?utm_source=errorcode_522&utm_campaign=api.avalai.ir" id="brand_link" target="_blank">Cloudflare</a></span>
    
  </p>
  <script>(function(){function d(){var b=a.getElementById("cf-footer-item-ip"),c=a.getElementById("cf-footer-ip-reveal");b&&"classList"in b&&(b.classList.remove("hidden"),c.addEventListener("click",function(){c.classList.add("hidden");a.getElementById("cf-footer-ip").classList.remove("hidden")}))}var a=document;document.addEventListener&&a.addEventListener("DOMContentLoaded",d)})();</script>
</div><!-- /.error-footer -->


    </div>
</div>
</body>
</html>
2025-08-09 13:58:58,236 - src.processing.ai_processor - ERROR - Error processing Excel file: <!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en-US"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en-US"> <!--<![endif]-->
<head>


<title>api.avalai.ir | 522: Connection timed out</title>
<meta charset="UTF-8" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta name="robots" content="noindex, nofollow" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<link rel="stylesheet" id="cf_styles-css" href="/cdn-cgi/styles/main.css" />


</head>
<body>
<div id="cf-wrapper">
    <div id="cf-error-details" class="p-0">
        <header class="mx-auto pt-10 lg:pt-6 lg:px-8 w-240 lg:w-full mb-8">
            <h1 class="inline-block sm:block sm:mb-2 font-light text-60 lg:text-4xl text-black-dark leading-tight mr-2">
              <span class="inline-block">Connection timed out</span>
              <span class="code-label">Error code 522</span>
            </h1>
            <div>
               Visit <a href="https://www.cloudflare.com/5xx-error-landing?utm_source=errorcode_522&utm_campaign=api.avalai.ir" target="_blank" rel="noopener noreferrer">cloudflare.com</a> for more information.
            </div>
            <div class="mt-3">2025-08-09 10:28:57 UTC</div>
        </header>
        <div class="my-8 bg-gradient-gray">
            <div class="w-240 lg:w-full mx-auto">
                <div class="clearfix md:px-8">
                  
<div id="cf-browser-status" class=" relative w-1/3 md:w-full py-15 md:p-0 md:py-8 md:text-left md:border-solid md:border-0 md:border-b md:border-gray-400 overflow-hidden float-left md:float-none text-center">
  <div class="relative mb-10 md:m-0">
    
    <span class="cf-icon-browser block md:hidden h-20 bg-center bg-no-repeat"></span>
    <span class="cf-icon-ok w-12 h-12 absolute left-1/2 md:left-auto md:right-0 md:top-0 -ml-6 -bottom-4"></span>
    
  </div>
  <span class="md:block w-full truncate">You</span>
  <h3 class="md:inline-block mt-3 md:mt-0 text-2xl text-gray-600 font-light leading-1.3">
    
    Browser
    
  </h3>
  <span class="leading-1.3 text-2xl text-green-success">Working</span>
</div>

<div id="cf-cloudflare-status" class=" relative w-1/3 md:w-full py-15 md:p-0 md:py-8 md:text-left md:border-solid md:border-0 md:border-b md:border-gray-400 overflow-hidden float-left md:float-none text-center">
  <div class="relative mb-10 md:m-0">
    <a href="https://www.cloudflare.com/5xx-error-landing?utm_source=errorcode_522&utm_campaign=api.avalai.ir" target="_blank" rel="noopener noreferrer">
    <span class="cf-icon-cloud block md:hidden h-20 bg-center bg-no-repeat"></span>
    <span class="cf-icon-ok w-12 h-12 absolute left-1/2 md:left-auto md:right-0 md:top-0 -ml-6 -bottom-4"></span>
    </a>
  </div>
  <span class="md:block w-full truncate">Frankfurt</span>
  <h3 class="md:inline-block mt-3 md:mt-0 text-2xl text-gray-600 font-light leading-1.3">
    <a href="https://www.cloudflare.com/5xx-error-landing?utm_source=errorcode_522&utm_campaign=api.avalai.ir" target="_blank" rel="noopener noreferrer">
    Cloudflare
    </a>
  </h3>
  <span class="leading-1.3 text-2xl text-green-success">Working</span>
</div>

<div id="cf-host-status" class="cf-error-source relative w-1/3 md:w-full py-15 md:p-0 md:py-8 md:text-left md:border-solid md:border-0 md:border-b md:border-gray-400 overflow-hidden float-left md:float-none text-center">
  <div class="relative mb-10 md:m-0">
    
    <span class="cf-icon-server block md:hidden h-20 bg-center bg-no-repeat"></span>
    <span class="cf-icon-error w-12 h-12 absolute left-1/2 md:left-auto md:right-0 md:top-0 -ml-6 -bottom-4"></span>
    
  </div>
  <span class="md:block w-full truncate">api.avalai.ir</span>
  <h3 class="md:inline-block mt-3 md:mt-0 text-2xl text-gray-600 font-light leading-1.3">
    
    Host
    
  </h3>
  <span class="leading-1.3 text-2xl text-red-error">Error</span>
</div>

                </div>
            </div>
        </div>

        <div class="w-240 lg:w-full mx-auto mb-8 lg:px-8">
            <div class="clearfix">
                <div class="w-1/2 md:w-full float-left pr-6 md:pb-10 md:pr-0 leading-relaxed">
                    <h2 class="text-3xl font-normal leading-1.3 mb-4">What happened?</h2>
                    <p>The initial connection between Cloudflare's network and the origin web server timed out. As a result, the web page can not be displayed.</p>
                </div>
                <div class="w-1/2 md:w-full float-left leading-relaxed">
                    <h2 class="text-3xl font-normal leading-1.3 mb-4">What can I do?</h2>
                          <h3 class="text-15 font-semibold mb-2">If you're a visitor of this website:</h3>
      <p class="mb-6">Please try again in a few minutes.</p>

      <h3 class="text-15 font-semibold mb-2">If you're the owner of this website:</h3>
      <p><span>Contact your hosting provider letting them know your web server is not completing requests. An Error 522 means that the request was able to connect to your web server, but that the request didn't finish. The most likely cause is that something on your server is hogging resources.</span> <a rel="noopener noreferrer" href="https://developers.cloudflare.com/support/troubleshooting/http-status-codes/cloudflare-5xx-errors/error-522/">Additional troubleshooting information here.</a></p>
                </div>
            </div>
        </div>

        <div class="cf-error-footer cf-wrapper w-240 lg:w-full py-10 sm:py-4 sm:px-8 mx-auto text-center sm:text-left border-solid border-0 border-t border-gray-300">
  <p class="text-13">
    <span class="cf-footer-item sm:block sm:mb-1">Cloudflare Ray ID: <strong class="font-semibold">96c690df5f7f613b</strong></span>
    <span class="cf-footer-separator sm:hidden">&bull;</span>
    <span id="cf-footer-item-ip" class="cf-footer-item hidden sm:block sm:mb-1">
      Your IP:
      <button type="button" id="cf-footer-ip-reveal" class="cf-footer-ip-reveal-btn">Click to reveal</button>
      <span class="hidden" id="cf-footer-ip">178.131.162.24</span>
      <span class="cf-footer-separator sm:hidden">&bull;</span>
    </span>
    <span class="cf-footer-item sm:block sm:mb-1"><span>Performance &amp; security by</span> <a rel="noopener noreferrer" href="https://www.cloudflare.com/5xx-error-landing?utm_source=errorcode_522&utm_campaign=api.avalai.ir" id="brand_link" target="_blank">Cloudflare</a></span>
    
  </p>
  <script>(function(){function d(){var b=a.getElementById("cf-footer-item-ip"),c=a.getElementById("cf-footer-ip-reveal");b&&"classList"in b&&(b.classList.remove("hidden"),c.addEventListener("click",function(){c.classList.add("hidden");a.getElementById("cf-footer-ip").classList.remove("hidden")}))}var a=document;document.addEventListener&&a.addEventListener("DOMContentLoaded",d)})();</script>
</div><!-- /.error-footer -->


    </div>
</div>
</body>
</html>
2025-08-09 13:58:58,239 - __main__ - ERROR - An error occurred: <!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en-US"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en-US"> <!--<![endif]-->
<head>


<title>api.avalai.ir | 522: Connection timed out</title>
<meta charset="UTF-8" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta name="robots" content="noindex, nofollow" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<link rel="stylesheet" id="cf_styles-css" href="/cdn-cgi/styles/main.css" />


</head>
<body>
<div id="cf-wrapper">
    <div id="cf-error-details" class="p-0">
        <header class="mx-auto pt-10 lg:pt-6 lg:px-8 w-240 lg:w-full mb-8">
            <h1 class="inline-block sm:block sm:mb-2 font-light text-60 lg:text-4xl text-black-dark leading-tight mr-2">
              <span class="inline-block">Connection timed out</span>
              <span class="code-label">Error code 522</span>
            </h1>
            <div>
               Visit <a href="https://www.cloudflare.com/5xx-error-landing?utm_source=errorcode_522&utm_campaign=api.avalai.ir" target="_blank" rel="noopener noreferrer">cloudflare.com</a> for more information.
            </div>
            <div class="mt-3">2025-08-09 10:28:57 UTC</div>
        </header>
        <div class="my-8 bg-gradient-gray">
            <div class="w-240 lg:w-full mx-auto">
                <div class="clearfix md:px-8">
                  
<div id="cf-browser-status" class=" relative w-1/3 md:w-full py-15 md:p-0 md:py-8 md:text-left md:border-solid md:border-0 md:border-b md:border-gray-400 overflow-hidden float-left md:float-none text-center">
  <div class="relative mb-10 md:m-0">
    
    <span class="cf-icon-browser block md:hidden h-20 bg-center bg-no-repeat"></span>
    <span class="cf-icon-ok w-12 h-12 absolute left-1/2 md:left-auto md:right-0 md:top-0 -ml-6 -bottom-4"></span>
    
  </div>
  <span class="md:block w-full truncate">You</span>
  <h3 class="md:inline-block mt-3 md:mt-0 text-2xl text-gray-600 font-light leading-1.3">
    
    Browser
    
  </h3>
  <span class="leading-1.3 text-2xl text-green-success">Working</span>
</div>

<div id="cf-cloudflare-status" class=" relative w-1/3 md:w-full py-15 md:p-0 md:py-8 md:text-left md:border-solid md:border-0 md:border-b md:border-gray-400 overflow-hidden float-left md:float-none text-center">
  <div class="relative mb-10 md:m-0">
    <a href="https://www.cloudflare.com/5xx-error-landing?utm_source=errorcode_522&utm_campaign=api.avalai.ir" target="_blank" rel="noopener noreferrer">
    <span class="cf-icon-cloud block md:hidden h-20 bg-center bg-no-repeat"></span>
    <span class="cf-icon-ok w-12 h-12 absolute left-1/2 md:left-auto md:right-0 md:top-0 -ml-6 -bottom-4"></span>
    </a>
  </div>
  <span class="md:block w-full truncate">Frankfurt</span>
  <h3 class="md:inline-block mt-3 md:mt-0 text-2xl text-gray-600 font-light leading-1.3">
    <a href="https://www.cloudflare.com/5xx-error-landing?utm_source=errorcode_522&utm_campaign=api.avalai.ir" target="_blank" rel="noopener noreferrer">
    Cloudflare
    </a>
  </h3>
  <span class="leading-1.3 text-2xl text-green-success">Working</span>
</div>

<div id="cf-host-status" class="cf-error-source relative w-1/3 md:w-full py-15 md:p-0 md:py-8 md:text-left md:border-solid md:border-0 md:border-b md:border-gray-400 overflow-hidden float-left md:float-none text-center">
  <div class="relative mb-10 md:m-0">
    
    <span class="cf-icon-server block md:hidden h-20 bg-center bg-no-repeat"></span>
    <span class="cf-icon-error w-12 h-12 absolute left-1/2 md:left-auto md:right-0 md:top-0 -ml-6 -bottom-4"></span>
    
  </div>
  <span class="md:block w-full truncate">api.avalai.ir</span>
  <h3 class="md:inline-block mt-3 md:mt-0 text-2xl text-gray-600 font-light leading-1.3">
    
    Host
    
  </h3>
  <span class="leading-1.3 text-2xl text-red-error">Error</span>
</div>

                </div>
            </div>
        </div>

        <div class="w-240 lg:w-full mx-auto mb-8 lg:px-8">
            <div class="clearfix">
                <div class="w-1/2 md:w-full float-left pr-6 md:pb-10 md:pr-0 leading-relaxed">
                    <h2 class="text-3xl font-normal leading-1.3 mb-4">What happened?</h2>
                    <p>The initial connection between Cloudflare's network and the origin web server timed out. As a result, the web page can not be displayed.</p>
                </div>
                <div class="w-1/2 md:w-full float-left leading-relaxed">
                    <h2 class="text-3xl font-normal leading-1.3 mb-4">What can I do?</h2>
                          <h3 class="text-15 font-semibold mb-2">If you're a visitor of this website:</h3>
      <p class="mb-6">Please try again in a few minutes.</p>

      <h3 class="text-15 font-semibold mb-2">If you're the owner of this website:</h3>
      <p><span>Contact your hosting provider letting them know your web server is not completing requests. An Error 522 means that the request was able to connect to your web server, but that the request didn't finish. The most likely cause is that something on your server is hogging resources.</span> <a rel="noopener noreferrer" href="https://developers.cloudflare.com/support/troubleshooting/http-status-codes/cloudflare-5xx-errors/error-522/">Additional troubleshooting information here.</a></p>
                </div>
            </div>
        </div>

        <div class="cf-error-footer cf-wrapper w-240 lg:w-full py-10 sm:py-4 sm:px-8 mx-auto text-center sm:text-left border-solid border-0 border-t border-gray-300">
  <p class="text-13">
    <span class="cf-footer-item sm:block sm:mb-1">Cloudflare Ray ID: <strong class="font-semibold">96c690df5f7f613b</strong></span>
    <span class="cf-footer-separator sm:hidden">&bull;</span>
    <span id="cf-footer-item-ip" class="cf-footer-item hidden sm:block sm:mb-1">
      Your IP:
      <button type="button" id="cf-footer-ip-reveal" class="cf-footer-ip-reveal-btn">Click to reveal</button>
      <span class="hidden" id="cf-footer-ip">178.131.162.24</span>
      <span class="cf-footer-separator sm:hidden">&bull;</span>
    </span>
    <span class="cf-footer-item sm:block sm:mb-1"><span>Performance &amp; security by</span> <a rel="noopener noreferrer" href="https://www.cloudflare.com/5xx-error-landing?utm_source=errorcode_522&utm_campaign=api.avalai.ir" id="brand_link" target="_blank">Cloudflare</a></span>
    
  </p>
  <script>(function(){function d(){var b=a.getElementById("cf-footer-item-ip"),c=a.getElementById("cf-footer-ip-reveal");b&&"classList"in b&&(b.classList.remove("hidden"),c.addEventListener("click",function(){c.classList.add("hidden");a.getElementById("cf-footer-ip").classList.remove("hidden")}))}var a=document;document.addEventListener&&a.addEventListener("DOMContentLoaded",d)})();</script>
</div><!-- /.error-footer -->


    </div>
</div>
</body>
</html>
2025-08-09 13:58:58,247 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\rabieii.amin\Desktop\tender clustering\process_tenders.py", line 138, in main
    result_path = processor.process_excel(
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rabieii.amin\Desktop\tender clustering\src\processing\ai_processor.py", line 215, in process_excel
    tender_ids = self.filter_consulting_tenders(tenders_data)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rabieii.amin\Desktop\tender clustering\src\processing\ai_processor.py", line 153, in filter_consulting_tenders
    response = self.client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_utils\_utils.py", line 287, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\resources\chat\completions\completions.py", line 925, in create
    return self._post(
           ^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_base_client.py", line 1239, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_base_client.py", line 1034, in request
    raise self._make_status_error_from_response(err.response) from None
openai.InternalServerError: <!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en-US"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en-US"> <!--<![endif]-->
<head>


<title>api.avalai.ir | 522: Connection timed out</title>
<meta charset="UTF-8" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta name="robots" content="noindex, nofollow" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<link rel="stylesheet" id="cf_styles-css" href="/cdn-cgi/styles/main.css" />


</head>
<body>
<div id="cf-wrapper">
    <div id="cf-error-details" class="p-0">
        <header class="mx-auto pt-10 lg:pt-6 lg:px-8 w-240 lg:w-full mb-8">
            <h1 class="inline-block sm:block sm:mb-2 font-light text-60 lg:text-4xl text-black-dark leading-tight mr-2">
              <span class="inline-block">Connection timed out</span>
              <span class="code-label">Error code 522</span>
            </h1>
            <div>
               Visit <a href="https://www.cloudflare.com/5xx-error-landing?utm_source=errorcode_522&utm_campaign=api.avalai.ir" target="_blank" rel="noopener noreferrer">cloudflare.com</a> for more information.
            </div>
            <div class="mt-3">2025-08-09 10:28:57 UTC</div>
        </header>
        <div class="my-8 bg-gradient-gray">
            <div class="w-240 lg:w-full mx-auto">
                <div class="clearfix md:px-8">
                  
<div id="cf-browser-status" class=" relative w-1/3 md:w-full py-15 md:p-0 md:py-8 md:text-left md:border-solid md:border-0 md:border-b md:border-gray-400 overflow-hidden float-left md:float-none text-center">
  <div class="relative mb-10 md:m-0">
    
    <span class="cf-icon-browser block md:hidden h-20 bg-center bg-no-repeat"></span>
    <span class="cf-icon-ok w-12 h-12 absolute left-1/2 md:left-auto md:right-0 md:top-0 -ml-6 -bottom-4"></span>
    
  </div>
  <span class="md:block w-full truncate">You</span>
  <h3 class="md:inline-block mt-3 md:mt-0 text-2xl text-gray-600 font-light leading-1.3">
    
    Browser
    
  </h3>
  <span class="leading-1.3 text-2xl text-green-success">Working</span>
</div>

<div id="cf-cloudflare-status" class=" relative w-1/3 md:w-full py-15 md:p-0 md:py-8 md:text-left md:border-solid md:border-0 md:border-b md:border-gray-400 overflow-hidden float-left md:float-none text-center">
  <div class="relative mb-10 md:m-0">
    <a href="https://www.cloudflare.com/5xx-error-landing?utm_source=errorcode_522&utm_campaign=api.avalai.ir" target="_blank" rel="noopener noreferrer">
    <span class="cf-icon-cloud block md:hidden h-20 bg-center bg-no-repeat"></span>
    <span class="cf-icon-ok w-12 h-12 absolute left-1/2 md:left-auto md:right-0 md:top-0 -ml-6 -bottom-4"></span>
    </a>
  </div>
  <span class="md:block w-full truncate">Frankfurt</span>
  <h3 class="md:inline-block mt-3 md:mt-0 text-2xl text-gray-600 font-light leading-1.3">
    <a href="https://www.cloudflare.com/5xx-error-landing?utm_source=errorcode_522&utm_campaign=api.avalai.ir" target="_blank" rel="noopener noreferrer">
    Cloudflare
    </a>
  </h3>
  <span class="leading-1.3 text-2xl text-green-success">Working</span>
</div>

<div id="cf-host-status" class="cf-error-source relative w-1/3 md:w-full py-15 md:p-0 md:py-8 md:text-left md:border-solid md:border-0 md:border-b md:border-gray-400 overflow-hidden float-left md:float-none text-center">
  <div class="relative mb-10 md:m-0">
    
    <span class="cf-icon-server block md:hidden h-20 bg-center bg-no-repeat"></span>
    <span class="cf-icon-error w-12 h-12 absolute left-1/2 md:left-auto md:right-0 md:top-0 -ml-6 -bottom-4"></span>
    
  </div>
  <span class="md:block w-full truncate">api.avalai.ir</span>
  <h3 class="md:inline-block mt-3 md:mt-0 text-2xl text-gray-600 font-light leading-1.3">
    
    Host
    
  </h3>
  <span class="leading-1.3 text-2xl text-red-error">Error</span>
</div>

                </div>
            </div>
        </div>

        <div class="w-240 lg:w-full mx-auto mb-8 lg:px-8">
            <div class="clearfix">
                <div class="w-1/2 md:w-full float-left pr-6 md:pb-10 md:pr-0 leading-relaxed">
                    <h2 class="text-3xl font-normal leading-1.3 mb-4">What happened?</h2>
                    <p>The initial connection between Cloudflare's network and the origin web server timed out. As a result, the web page can not be displayed.</p>
                </div>
                <div class="w-1/2 md:w-full float-left leading-relaxed">
                    <h2 class="text-3xl font-normal leading-1.3 mb-4">What can I do?</h2>
                          <h3 class="text-15 font-semibold mb-2">If you're a visitor of this website:</h3>
      <p class="mb-6">Please try again in a few minutes.</p>

      <h3 class="text-15 font-semibold mb-2">If you're the owner of this website:</h3>
      <p><span>Contact your hosting provider letting them know your web server is not completing requests. An Error 522 means that the request was able to connect to your web server, but that the request didn't finish. The most likely cause is that something on your server is hogging resources.</span> <a rel="noopener noreferrer" href="https://developers.cloudflare.com/support/troubleshooting/http-status-codes/cloudflare-5xx-errors/error-522/">Additional troubleshooting information here.</a></p>
                </div>
            </div>
        </div>

        <div class="cf-error-footer cf-wrapper w-240 lg:w-full py-10 sm:py-4 sm:px-8 mx-auto text-center sm:text-left border-solid border-0 border-t border-gray-300">
  <p class="text-13">
    <span class="cf-footer-item sm:block sm:mb-1">Cloudflare Ray ID: <strong class="font-semibold">96c690df5f7f613b</strong></span>
    <span class="cf-footer-separator sm:hidden">&bull;</span>
    <span id="cf-footer-item-ip" class="cf-footer-item hidden sm:block sm:mb-1">
      Your IP:
      <button type="button" id="cf-footer-ip-reveal" class="cf-footer-ip-reveal-btn">Click to reveal</button>
      <span class="hidden" id="cf-footer-ip">178.131.162.24</span>
      <span class="cf-footer-separator sm:hidden">&bull;</span>
    </span>
    <span class="cf-footer-item sm:block sm:mb-1"><span>Performance &amp; security by</span> <a rel="noopener noreferrer" href="https://www.cloudflare.com/5xx-error-landing?utm_source=errorcode_522&utm_campaign=api.avalai.ir" id="brand_link" target="_blank">Cloudflare</a></span>
    
  </p>
  <script>(function(){function d(){var b=a.getElementById("cf-footer-item-ip"),c=a.getElementById("cf-footer-ip-reveal");b&&"classList"in b&&(b.classList.remove("hidden"),c.addEventListener("click",function(){c.classList.add("hidden");a.getElementById("cf-footer-ip").classList.remove("hidden")}))}var a=document;document.addEventListener&&a.addEventListener("DOMContentLoaded",d)})();</script>
</div><!-- /.error-footer -->


    </div>
</div>
</body>
</html>

2025-08-09 14:52:39,828 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 14:52:39,828 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_133907.xlsx
2025-08-09 14:52:39,829 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_133907.xlsx
2025-08-09 14:52:40,140 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_145239.xlsx
2025-08-09 14:52:40,346 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 14:52:40,346 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_145239.xlsx
2025-08-09 14:52:40,383 - src.processing.ai_processor - INFO - Filtering 447 tenders
2025-08-09 14:52:40,384 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 14:52:46,517 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-09 14:52:46,526 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-09 14:52:46,527 - src.processing.ai_processor - INFO - Found 19 consulting tenders
2025-08-09 14:52:46,528 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_145239.xlsx
2025-08-09 14:52:46,545 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_133907.xlsx
2025-08-09 14:52:46,620 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250809_145239.xlsx
2025-08-09 14:52:46,640 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_145239.xlsx
2025-08-09 14:52:46,640 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_236_20250809_133907.xlsx
2025-08-09 14:54:22,598 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 14:54:22,599 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_133907.xlsx
2025-08-09 14:54:22,599 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_133907.xlsx
2025-08-09 14:54:22,913 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_145422.xlsx
2025-08-09 14:54:23,120 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 14:54:23,121 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_145422.xlsx
2025-08-09 14:54:23,157 - src.processing.ai_processor - INFO - Filtering 447 tenders
2025-08-09 14:54:23,158 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 14:54:30,103 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-09 14:54:30,108 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-09 14:54:30,108 - src.processing.ai_processor - INFO - Found 18 consulting tenders
2025-08-09 14:54:30,109 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_145422.xlsx
2025-08-09 14:54:30,128 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_133907.xlsx
2025-08-09 14:54:30,203 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250809_145422.xlsx
2025-08-09 14:54:30,224 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_145422.xlsx
2025-08-09 14:54:30,224 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_236_20250809_133907.xlsx
2025-08-09 15:33:37,498 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 15:33:37,498 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_133907.xlsx
2025-08-09 15:33:37,499 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_133907.xlsx
2025-08-09 15:33:37,817 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_153337.xlsx
2025-08-09 15:33:38,030 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 15:33:38,030 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_153337.xlsx
2025-08-09 15:33:38,068 - src.processing.ai_processor - INFO - Filtering 447 tenders
2025-08-09 15:33:38,070 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 15:33:49,441 - openai._base_client - INFO - Retrying request to /chat/completions in 0.390004 seconds
2025-08-09 15:34:04,599 - openai._base_client - INFO - Retrying request to /chat/completions in 0.911029 seconds
2025-08-09 15:34:23,322 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-09 15:34:23,329 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-09 15:34:23,329 - src.processing.ai_processor - INFO - Found 18 consulting tenders
2025-08-09 15:34:23,330 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_153337.xlsx
2025-08-09 15:34:23,348 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_133907.xlsx
2025-08-09 15:34:23,424 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250809_153337.xlsx
2025-08-09 15:34:23,444 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_153337.xlsx
2025-08-09 15:34:23,444 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_236_20250809_133907.xlsx
2025-08-09 15:37:20,601 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 15:37:20,602 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_133907.xlsx
2025-08-09 15:37:20,602 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_133907.xlsx
2025-08-09 15:37:20,918 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_153720.xlsx
2025-08-09 15:37:21,126 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 15:37:21,126 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_153720.xlsx
2025-08-09 15:37:21,163 - src.processing.ai_processor - INFO - Filtering 447 tenders
2025-08-09 15:37:21,164 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 15:37:39,772 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-09 15:37:39,776 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-09 15:37:39,776 - src.processing.ai_processor - INFO - Found 19 consulting tenders
2025-08-09 15:37:39,777 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_153720.xlsx
2025-08-09 15:37:39,796 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_133907.xlsx
2025-08-09 15:37:39,871 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250809_153720.xlsx
2025-08-09 15:37:39,891 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_153720.xlsx
2025-08-09 15:37:39,891 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_236_20250809_133907.xlsx
2025-08-09 15:38:30,177 - __main__ - INFO - Processing HTML files from C:\Users\rabieii.amin\Desktop\tender clustering\data\input
2025-08-09 15:38:30,178 - __main__ - INFO - Found 1 HTML files
2025-08-09 15:38:30,179 - __main__ - INFO - Parsing 236.html
2025-08-09 15:38:50,215 - __main__ - INFO - Saved tender information to C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_153849.xlsx
2025-08-09 15:38:50,771 - __main__ - INFO - Successfully processed 1 HTML files
2025-08-09 15:38:50,784 - __main__ - INFO - AI processing and email sending not yet implemented
2025-08-09 15:38:55,742 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 15:38:55,743 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_153849.xlsx
2025-08-09 15:38:55,744 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_153849.xlsx
2025-08-09 15:38:56,069 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_153855.xlsx
2025-08-09 15:38:56,281 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 15:38:56,281 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_153855.xlsx
2025-08-09 15:38:56,319 - src.processing.ai_processor - INFO - Filtering 447 tenders
2025-08-09 15:38:56,320 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 15:39:06,828 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-09 15:39:06,837 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-09 15:39:06,837 - src.processing.ai_processor - INFO - Found 19 consulting tenders
2025-08-09 15:39:06,839 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_153855.xlsx
2025-08-09 15:39:06,857 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_153849.xlsx
2025-08-09 15:39:06,932 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250809_153855.xlsx
2025-08-09 15:39:06,952 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_153855.xlsx
2025-08-09 15:39:06,953 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_236_20250809_153849.xlsx
2025-08-09 15:42:18,821 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 15:42:18,821 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_153849.xlsx
2025-08-09 15:42:18,822 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_153849.xlsx
2025-08-09 15:42:19,143 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_154218.xlsx
2025-08-09 15:42:19,352 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 15:42:19,353 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_154218.xlsx
2025-08-09 15:42:19,390 - src.processing.ai_processor - INFO - Filtering 447 tenders
2025-08-09 15:42:19,392 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 15:42:29,694 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-09 15:42:29,698 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-09 15:42:29,698 - src.processing.ai_processor - INFO - Found 18 consulting tenders
2025-08-09 15:42:29,700 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_154218.xlsx
2025-08-09 15:42:29,718 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_153849.xlsx
2025-08-09 15:42:29,794 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250809_154218.xlsx
2025-08-09 15:42:29,814 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_154218.xlsx
2025-08-09 15:42:29,814 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_236_20250809_153849.xlsx
2025-08-09 15:42:57,787 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 15:42:57,787 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_153849.xlsx
2025-08-09 15:42:57,788 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_153849.xlsx
2025-08-09 15:42:58,107 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_154257.xlsx
2025-08-09 15:42:58,314 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 15:42:58,315 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_154257.xlsx
2025-08-09 15:42:58,352 - src.processing.ai_processor - INFO - Filtering 447 tenders
2025-08-09 15:42:58,354 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 15:43:08,690 - openai._base_client - INFO - Retrying request to /chat/completions in 0.499417 seconds
2025-08-09 15:43:17,687 - openai._base_client - INFO - Retrying request to /chat/completions in 0.794551 seconds
2025-08-09 15:43:33,948 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-09 15:43:33,956 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-09 15:43:33,956 - src.processing.ai_processor - INFO - Found 14 consulting tenders
2025-08-09 15:43:33,959 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_154257.xlsx
2025-08-09 15:43:33,978 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_153849.xlsx
2025-08-09 15:43:34,056 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250809_154257.xlsx
2025-08-09 15:43:34,077 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_154257.xlsx
2025-08-09 15:43:34,077 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_236_20250809_153849.xlsx
2025-08-09 15:44:37,484 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 15:44:37,484 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_153849.xlsx
2025-08-09 15:44:37,485 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_153849.xlsx
2025-08-09 15:44:37,803 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_154437.xlsx
2025-08-09 15:44:38,009 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 15:44:38,009 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_154437.xlsx
2025-08-09 15:44:38,047 - src.processing.ai_processor - INFO - Filtering 447 tenders
2025-08-09 15:44:38,049 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 15:44:44,577 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-09 15:44:44,583 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-09 15:44:44,583 - src.processing.ai_processor - INFO - Found 18 consulting tenders
2025-08-09 15:44:44,584 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_154437.xlsx
2025-08-09 15:44:44,602 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\236_20250809_153849.xlsx
2025-08-09 15:44:44,677 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250809_154437.xlsx
2025-08-09 15:44:44,697 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_154437.xlsx
2025-08-09 15:44:44,697 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_236_20250809_153849.xlsx
2025-08-09 15:46:23,064 - __main__ - INFO - Processing HTML files from C:\Users\rabieii.amin\Desktop\tender clustering\data\input
2025-08-09 15:46:23,064 - __main__ - INFO - Found 1 HTML files
2025-08-09 15:46:23,065 - __main__ - INFO - Parsing 237.html
2025-08-09 15:46:34,314 - __main__ - INFO - Saved tender information to C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\237_20250809_154634.xlsx
2025-08-09 15:46:34,314 - __main__ - INFO - Successfully processed 1 HTML files
2025-08-09 15:46:34,315 - __main__ - INFO - AI processing and email sending not yet implemented
2025-08-09 15:46:42,989 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-09 15:46:42,989 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\237_20250809_154634.xlsx
2025-08-09 15:46:42,990 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\237_20250809_154634.xlsx
2025-08-09 15:46:43,270 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_154642.xlsx
2025-08-09 15:46:43,476 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-09 15:46:43,477 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250809_154642.xlsx
2025-08-09 15:46:43,505 - src.processing.ai_processor - INFO - Filtering 253 tenders
2025-08-09 15:46:43,505 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-09 15:46:49,224 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-09 15:46:49,228 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-09 15:46:49,228 - src.processing.ai_processor - INFO - Found 10 consulting tenders
2025-08-09 15:46:49,229 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_154642.xlsx
2025-08-09 15:46:49,246 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\237_20250809_154634.xlsx
2025-08-09 15:46:49,291 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250809_154642.xlsx
2025-08-09 15:46:49,309 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250809_154642.xlsx
2025-08-09 15:46:49,310 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_237_20250809_154634.xlsx
2025-08-16 12:12:22,276 - __main__ - INFO - Processing HTML files from C:\Users\rabieii.amin\Desktop\tender clustering\data\input
2025-08-16 12:12:22,277 - __main__ - INFO - Found 1 HTML files
2025-08-16 12:12:22,277 - __main__ - INFO - Parsing 237.html
2025-08-16 12:12:34,691 - __main__ - INFO - Saved tender information to C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\237_20250816_121234.xlsx
2025-08-16 12:12:34,692 - __main__ - INFO - Successfully processed 1 HTML files
2025-08-16 12:12:34,692 - __main__ - INFO - AI processing and email sending not yet implemented
2025-08-16 12:15:59,993 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-16 12:15:59,994 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\237_20250816_121234.xlsx
2025-08-16 12:15:59,994 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\237_20250816_121234.xlsx
2025-08-16 12:16:00,341 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250816_121559.xlsx
2025-08-16 12:16:42,123 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-16 12:16:42,124 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\237_20250816_121234.xlsx
2025-08-16 12:16:42,124 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\237_20250816_121234.xlsx
2025-08-16 12:16:42,389 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250816_121642.xlsx
2025-08-16 12:16:43,128 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-16 12:16:43,128 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250816_121642.xlsx
2025-08-16 12:16:43,152 - src.processing.ai_processor - INFO - Filtering 253 tenders
2025-08-16 12:16:43,153 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-16 12:17:20,209 - openai._base_client - INFO - Retrying request to /chat/completions in 0.499371 seconds
2025-08-16 12:17:55,403 - openai._base_client - INFO - Retrying request to /chat/completions in 0.751946 seconds
2025-08-16 12:18:28,923 - src.processing.ai_processor - ERROR - Error filtering consulting tenders: Connection error.
2025-08-16 12:18:28,923 - src.processing.ai_processor - ERROR - Error processing Excel file: Connection error.
2025-08-16 12:18:28,923 - __main__ - ERROR - An error occurred: Connection error.
2025-08-16 12:18:28,944 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\httpx\_transports\default.py", line 101, in map_httpcore_exceptions
    yield
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\httpcore\_sync\connection_pool.py", line 256, in handle_request
    raise exc from None
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\httpcore\_sync\http_proxy.py", line 343, in handle_request
    return self._connection.handle_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\httpcore\_sync\http11.py", line 136, in handle_request
    raise exc
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\httpcore\_sync\http11.py", line 106, in handle_request
    ) = self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\httpcore\_sync\http11.py", line 177, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\httpcore\_sync\http11.py", line 231, in _receive_event
    raise RemoteProtocolError(msg)
httpcore.RemoteProtocolError: Server disconnected without sending a response.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_base_client.py", line 969, in request
    response = self._client.send(
               ^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\httpx\_transports\default.py", line 249, in handle_request
    with map_httpcore_exceptions():
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\httpx\_transports\default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.RemoteProtocolError: Server disconnected without sending a response.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\rabieii.amin\Desktop\tender clustering\process_tenders.py", line 138, in main
    result_path = processor.process_excel(
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rabieii.amin\Desktop\tender clustering\src\processing\ai_processor.py", line 226, in process_excel
    tender_ids = self.filter_consulting_tenders(tenders_data)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rabieii.amin\Desktop\tender clustering\src\processing\ai_processor.py", line 164, in filter_consulting_tenders
    response = self.client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_utils\_utils.py", line 287, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\resources\chat\completions\completions.py", line 925, in create
    return self._post(
           ^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_base_client.py", line 1239, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\Anaconda3\envs\detection\Lib\site-packages\openai\_base_client.py", line 1001, in request
    raise APIConnectionError(request=request) from err
openai.APIConnectionError: Connection error.

2025-08-16 12:18:47,683 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-16 12:18:47,683 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\237_20250816_121234.xlsx
2025-08-16 12:18:47,683 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\237_20250816_121234.xlsx
2025-08-16 12:18:47,952 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250816_121847.xlsx
2025-08-16 12:18:48,233 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-16 12:18:48,233 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250816_121847.xlsx
2025-08-16 12:18:48,253 - src.processing.ai_processor - INFO - Filtering 253 tenders
2025-08-16 12:18:48,254 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-16 12:23:08,379 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-16 12:23:08,379 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\237_20250816_121234.xlsx
2025-08-16 12:23:08,379 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\237_20250816_121234.xlsx
2025-08-16 12:23:08,648 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250816_122308.xlsx
2025-08-16 12:23:08,925 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-16 12:23:08,925 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250816_122308.xlsx
2025-08-16 12:23:08,946 - src.processing.ai_processor - INFO - Filtering 253 tenders
2025-08-16 12:23:08,947 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-16 12:23:13,096 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-16 12:23:13,105 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-16 12:23:13,106 - src.processing.ai_processor - INFO - Found 9 consulting tenders
2025-08-16 12:23:13,114 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250816_122308.xlsx
2025-08-16 12:23:13,122 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\237_20250816_121234.xlsx
2025-08-16 12:23:13,167 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250816_122308.xlsx
2025-08-16 12:23:13,179 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250816_122308.xlsx
2025-08-16 12:23:13,179 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_237_20250816_121234.xlsx
2025-08-16 12:24:45,807 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-16 12:24:45,807 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\237_20250816_121234.xlsx
2025-08-16 12:24:45,807 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\237_20250816_121234.xlsx
2025-08-16 12:24:46,071 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250816_122445.xlsx
2025-08-16 12:24:46,351 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-16 12:24:46,352 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250816_122445.xlsx
2025-08-16 12:24:46,371 - src.processing.ai_processor - INFO - Filtering 253 tenders
2025-08-16 12:24:46,372 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-16 12:24:49,805 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-16 12:24:49,807 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-16 12:24:49,808 - src.processing.ai_processor - INFO - Found 9 consulting tenders
2025-08-16 12:24:49,808 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250816_122445.xlsx
2025-08-16 12:24:49,817 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\237_20250816_121234.xlsx
2025-08-16 12:24:49,862 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250816_122445.xlsx
2025-08-16 12:24:49,870 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250816_122445.xlsx
2025-08-16 12:24:49,870 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_237_20250816_121234.xlsx
2025-08-16 12:25:41,118 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-16 12:25:41,119 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\237_20250816_121234.xlsx
2025-08-16 12:25:41,120 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\237_20250816_121234.xlsx
2025-08-16 12:25:41,386 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250816_122541.xlsx
2025-08-16 12:25:41,672 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-16 12:25:41,672 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250816_122541.xlsx
2025-08-16 12:25:41,695 - src.processing.ai_processor - INFO - Filtering 253 tenders
2025-08-16 12:25:41,696 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-16 12:29:24,834 - __main__ - INFO - No input file specified, looking for the latest Excel file in C:\Users\rabieii.amin\Desktop\tender clustering\data\processed
2025-08-16 12:29:24,835 - __main__ - INFO - Using latest Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\237_20250816_121234.xlsx
2025-08-16 12:29:24,835 - __main__ - INFO - Preparing data from C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\237_20250816_121234.xlsx
2025-08-16 12:29:25,107 - __main__ - INFO - Extracted data saved to C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250816_122924.xlsx
2025-08-16 12:29:25,391 - src.processing.ai_processor - INFO - AI processor initialized successfully
2025-08-16 12:29:25,391 - src.processing.ai_processor - INFO - Reading Excel file: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\extracted_20250816_122924.xlsx
2025-08-16 12:29:25,411 - src.processing.ai_processor - INFO - Filtering 253 tenders
2025-08-16 12:29:25,412 - src.processing.ai_processor - INFO - Sending request to language model
2025-08-16 12:29:28,609 - httpx - INFO - HTTP Request: POST https://api.avalai.ir/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-16 12:29:28,611 - src.processing.ai_processor - INFO - Parsing language model response
2025-08-16 12:29:28,611 - src.processing.ai_processor - INFO - Found 9 consulting tenders
2025-08-16 12:29:28,612 - src.processing.ai_processor - INFO - Saving filtered tenders to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250816_122924.xlsx
2025-08-16 12:29:28,621 - src.processing.ai_processor - INFO - Reading full data from: C:\Users\rabieii.amin\Desktop\tender clustering\data\processed\237_20250816_121234.xlsx
2025-08-16 12:29:28,666 - src.processing.ai_processor - INFO - Saving full filtered data to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_extracted_20250816_122924.xlsx
2025-08-16 12:29:28,679 - __main__ - INFO - Processing completed. Results saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\filtered_20250816_122924.xlsx
2025-08-16 12:29:28,679 - __main__ - INFO - Full filtered data saved to: C:\Users\rabieii.amin\Desktop\tender clustering\data\output\ai_filtered\full_filtered_237_20250816_121234.xlsx
